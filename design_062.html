<!doctype html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>游戏开发: 游戏开发框架</title>
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="stylesheet" href="css/templete.css" type="text/css" media="all" />
    <meta charset="UTF-8">
</head>
<body class="level-2">
    <div class="wrapper">
        <!--Begin header-->
        <div class="header">
            <div class="grid-container clearfix">
                <div class="header-left">
                    <img alt="Microsoft" src="http://i.s-microsoft.com/global/ImageStore/PublishingImages/logos/hp/logo-lg-1x.png" width="94" height="20">
                    <h1>X-Platform</h1>
                </div>
                <div id="mscom-search" class="mscom-search" style="margin-top: 37px;">
                    <div class="search-form">
                        <form action="" id="search-form">
                            <div class="input-wrapper">
                                <label class="screen-reader-text" for="search-input">搜索 Microsoft.com</label>
                                <input id="search-input" type="text" class="input-area" autocomplete="off">
                            </div>
                            <button class="search-submit" id="search-btn" type="submit">
                                <img width="16" height="16" alt="Submit" src="http://i.s-microsoft.com/global/imagestore/PublishingImages/sprites/search-button-blue.png"></button>
                        </form>
                    </div>
                    <div class="search-results-box" id="results">
                        <div class="search-scope">
                            <ul>
                                <li class=""><a class="checked" search="microsoft" role="search">搜索 Microsoft.com</a></li>
                                <li class=""><a search="internet" role="search">搜索互联网</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--End header-->
        <br />
        <!--Begin Content-->
        <div class="content">
            <div class="wrapper">
                <div class="wrapper-header">
                    <div>
                        <a href="index.html">
                            <img src="./assets/image/banner_1.jpg"></a>
                    </div>
                </div>
                <div class="main">
                    <div class="nav">
                        <div class="block article-nav-block">
                            <h2>移动应用开发生命周期</h2>
                            <div class="menu">
                                <h3><a href="idea.html">计划<span>Idea/Planning</span></a></h3>
                                <ul>
                                    <li><a href="idea_01.html">平台总览</a></li>
                                    <li><a href="idea_02.html">开发工具、开发环境和模拟器</a></li>
                                    <li><a href="idea_03.html">应用结构和生命周期</a></li>
                                </ul>
                            </div>
                            <div class="menu active">
                                <h3><a href="design.html">设计<span>Design</span></a></h3>
                                <ul>
                                    <li><a href="design_01.html">UI Layout的设计</a></li>
                                    <li><a href="design_02.html">UI的控件</a></li>
                                    <li><a href="design_03.html">UI页面的控制和导航</a></li>
                                    <li><a href="design_04.html">不同屏幕尺寸和分辨率的适配</a></li>
                                    <li><a href="design_05.html">第三方SDK</a></li>
                                    <li><a href="design_06.html">游戏开发</a></li>
                                </ul>
                            </div>
                            <div class="menu">
                                <h3><a href="developing.html">开发<span>Developing</span></a></h3>
                                <ul>
                                    <li><a href="developing_01.html">开发语言</a></li>
                                    <li><a href="developing_02.html">Audio、Video Player应用的开发</a></li>
                                    <li><a href="developing_03.html">General APIs Mapping</a></li>
                                    <li><a href="developing_04.html">IAP应用内支付</a></li>
                                    <li><a href="developing_05.html">LBS应用</a></li>
                                    <li><a href="developing_06.html">LBS、镜头和传感器应用接口使用</a></li>
                                    <li><a href="developing_07.html">Native Code（C和C++）支持</a></li>
                                    <li><a href="developing_08.html">Push Notification</a></li>
                                    <li><a href="developing_09.html">Sharing in Social Network</a></li>
                                    <li><a href="developing_10.html">Source Code Control</a></li>
                                    <li><a href="developing_11.html">UI上的Data Binding</a></li>
                                    <li><a href="developing_12.html">Windows 8.1和WP 8 Sharing应用分享功能实现</a></li>
                                    <li><a href="developing_13.html">多媒体</a></li>
                                    <li><a href="developing_14.html">后台任务和多任务处理</a></li>
                                    <li><a href="developing_15.html">获取后台服务器数据</a></li>
                                    <li><a href="developing_16.html">浏览器控件WebView</a></li>
                                    <li><a href="developing_17.html">数据库（SQLite）</a></li>
                                    <li><a href="developing_18.html">数据网络和数据通讯</a></li>
                                    <li><a href="developing_19.html">通话和短信功能</a></li>
                                    <li><a href="developing_20.html">图形处理(Drawing & Animation)</a></li>
                                    <li><a href="developing_21.html">文件系统和应用设置</a></li>
                                    <li><a href="developing_22.html">应用间通信</a></li>
                                    <li><a href="developing_23.html">支付方式</a></li>
                                    <li><a href="developing_24.html">Windows 8.1应用外设开发</a></li>
                                </ul>
                            </div>
                            <div class="menu">
                                <h3><a href="testing.html">测试<span>Testing</span></a></h3>
                                <ul>
                                    <li><a href="testing_01.html">Windows 8 and WP 8开发FAQ</a></li>
                                </ul>
                            </div>
                            <div class="menu last">
                                <h3><a href="distribute.html">发布<span>Distribute</span></a></h3>
                                <ul>
                                    <li><a href="distribute_01.html">应用商店(发布和更新应用)</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="block success-story-nav-block">
                            <h2>成功案例</h2>
                        </div>
                        <div class="block others">
                            <a href="sample_code.html" class="left">示例代码</a>
                            <a href="http://msdn.microsoft.com/zh-cn/dn473954" class="right">教学视频</a>
                        </div>
                    </div>
                    <div class="content">
                        <div class="textlist">
                            游戏开发<br />
                            <ul>
                                <li><a href="design_06.html">多平台游戏渲染开发</a>
                                <li><a href="design_061.html">如何在WP8上搭建cocos2d-x的游戏开发环境</a>
                                <li><a href="design_062.html">●游戏开发框架</a>
                            </ul>
                        </div>
                        <h3 class="title">游戏开发框架<span><a href="index.html">返回首页&gt;</a></span></h3>
                        <div class="article-content">
                            <div class="WordSection1">
                                <p class="MsoToc1"><a href="#_Toc372636864">1 游戏开发框架</a></p>
                                <p class="MsoToc2"><a href="#_Toc372636865">1.1 主要功能</a></p>
                                <p class="MsoToc1"><a href="#_Toc372636866">2 Windows Phone 8 游戏开发框架</a></p>
                                <p class="MsoToc2"><a href="#_Toc372636867">2.1 为 Windows Phone 8 的游戏选择正确的项目模板</a></p>
                                <p class="MsoToc3"><a href="#_Toc372636868">2.1.1 托管应用程序</a></p>
                                <p class="MsoToc3"><a href="#_Toc372636869">2.1.2 Direct3D 应用</a></p>
                                <p class="MsoToc3"><a href="#_Toc372636870">2.1.3 何种应用程序模型适合您的应用？</a></p>
                                <p class="MsoToc2"><a href="#_Toc372636871">2.2 Windows Phone 8 的 Direct3D</a></p>
                                <p class="MsoToc3"><a href="#_Toc372636872">2.2.1 手机和桌面游戏开发之间的差别</a></p>
                                <p class="MsoToc3">
                                    <a href="#_Toc372636873">2.2.2 Windows Phone
8 的 Direct3D 功能级别 9_3</a>
                                </p>
                                <p class="MsoToc3">
                                    <a href="#_Toc372636874">2.2.3 Windows Phone
8 的着色器模型支持</a>
                                </p>
                                <p class="MsoToc3"><a href="#_Toc372636875">2.2.4 为 Windows Phone 8 创建 Direct3D 设备和交换链</a></p>
                                <p class="MsoToc3"><a href="#_Toc372636876">2.2.5 在 Windows Phone 8 的 Direct3D 中启用抗锯齿</a></p>
                                <p class="MsoToc3"><a href="#_Toc372636877">2.2.6 优化 Windows Phone 8 基于图块的呈现</a></p>
                                <div class="WordSection2">
                                    <h1><a name="_Toc372636864">1 游戏开发框架</a></h1>
                                    <p>
                                        Cocos2D-X是多平台开发中一个非常有用的库，它可以让你在创建自己的多平台游戏时节省很多的时间。支持的平台有<a
                                            href="http://baike.baidu.com/view/2708518.htm" target="_blank">Windows Phone</a>，Windows 商店应用，<a
                                                href="http://baike.baidu.com/view/158983.htm" target="_blank">iOS</a>，<a
                                                    href="http://baike.baidu.com/view/1241829.htm" target="_blank">Android</a>。它具有很多的功能，比如sprite(精灵)扶持，非常酷的图形效果，<a
                                                        href="http://baike.baidu.com/view/7262.htm" target="_blank">动画</a>效果，物理库，音频引擎等等。
                                    </p>
                                    <p>
                                        Cocos2d-iPhone是基于 GNU LGPL
v3 license的，考虑到在iPhone的平台上无法实现发布第三方<a
    href="http://baike.baidu.com/view/887.htm" target="_blank">动态链接库</a>，因此它扩展了上述协议，允许通过<a href="http://baike.baidu.com/view/760168.htm" target="_blank">静态链接库</a>或者直接使用<a
        href="http://baike.baidu.com/view/60376.htm" target="_blank">源代码</a>的方式实现你的应用，而不必公开你的<a
            href="http://baike.baidu.com/view/60376.htm" target="_blank">源代码</a>。你不用担心这个开源引擎的效率和可能存在的内在限制，因为：在苹果AppStore上已经有超过100个游戏是基于Cocos2D-iPhone。其中3个由此进入过TOP 10的排名。其中的 StickWars更是曾排名第一。
                                    </p>
                                    <p>
                                        Cocos2D-X是一个开源、免费的游戏开发引擎<a
                                            name="ref_[1]_3800461"></a>，也即游戏开发框架，可用于构建2D游戏、演示程序和其他图形界面的交互应用等。
                                    </p>
                                    <h2><a name="_Toc372636865">1.1 主要功能</a></h2>
                                    <p>
                                        <a href="http://baike.baidu.com/view/2846066.htm"
                                            target="_blank">流程控制</a>（Flow
control）：非常容易地管理不同场景（scenes）之间的流程控制
                                    </p>
                                    <p>精灵（Sprites）：快速而方便的精灵</p>
                                    <p>动作（Actions）：告诉精灵们该做什么。可组合的动作如移动（move）、旋转（rotate）和缩放（scale）等更多</p>
                                    <p>特效（Effects）：特效包括<a href="http://baike.baidu.com/view/340524.htm" target="_blank">波浪</a>（waves）、旋转（twirl）和透镜（lens）等更多</p>
                                    <p>平面地图（Tiled Maps）：支持包括矩形和六边形平面地图</p>
                                    <p>转换（Transitions）：从一个场景移动到另外一个不同风格的场景</p>
                                    <p>
                                        <a href="http://baike.baidu.com/view/102616.htm"
                                            target="_blank">菜单</a>（Menus）：创建内部菜单
                                    </p>
                                    <p>
                                        文本渲染（Text
Rendering）：支持标签和<a href="http://baike.baidu.com/view/692.htm" target="_blank">HTML</a>标签动作
                                    </p>
                                    <p>文档（Documents）：编程指南 + API参考 + 视频教学 + 很多教你如何使用的简单测试例子</p>
                                    <p>基于Pyglet：没有外部的依赖</p>
                                    <p>基于OpenGL：支持<a href="http://baike.baidu.com/view/1039397.htm" target="_blank">硬件加速</a></p>
                                    <h1><a name="_Toc372636866">2 Windows Phone 8 游戏开发框架</a></h1>
                                    <h2><a name="_Toc372636867">2.1 为 Windows Phone 8 的游戏选择正确的项目模板</a></h2>
                                    <h3><a name="_Toc372636868">2.1.1 </a>托管应用程序</h3>
                                    <p>
                                        Windows
Phone 8 为
托管的应用 提供多个不同的项目模板，它们全部位于新建项目对话中
Templates-&gt;Visual C#-&gt; Windows Phone 或
Templates-&gt;Visual Basic-&gt; Windows Phone 下的 Visual
Studio 中。以下列表介绍
托管的应用 的一些功能。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
                                <b>应用模型</b> - 托管的应用 的应用模型与之前版本的
Windows&nbsp;Phone 的模型几乎完全相同。您的应用程序将由一个主应用程序对象和一个或多个 PhoneApplicationPage 对象组成，它们全部用 XAML 和 C# 或 XAML 和 VB.NET 实现。每一个页面实现一个用户界面，用户在这些页面之间导航以访问应用程序的不同部分。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
                                <b>UI</b> - 使用 XAML 定义 托管的应用 用户界面。Visual
Studio 和 Microsoft
Expression Blend 的内置设计器中有较大的可用控件库，它支持数据绑定，您可以轻松地对它进行布局。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
                                <b>独有功能</b> - 只有 托管的应用 可使用以下功能，仅限本机的应用程序无法使用。
                                    </p>
                                    <p style='margin-left: 72.0pt;'>
                                        o&nbsp;
后台代理
                                    </p>
                                    <p style='margin-left: 72.0pt;'>
                                        o&nbsp;
浏览器控件
                                    </p>
                                    <p style='margin-left: 72.0pt;'>
                                        o&nbsp;
地图控件
                                    </p>
                                    <p style='margin-left: 72.0pt;'>
                                        o&nbsp;
后台传输服务
                                    </p>
                                    <p style='margin-left: 72.0pt;'>
                                        o&nbsp;
实时拼贴
                                    </p>
                                    <p style='margin-left: 72.0pt;'>
                                        o&nbsp;
推送通知
                                    </p>
                                    <p style='margin-left: 72.0pt;'>
                                        o&nbsp;
Windows&nbsp;Phone 广告控件
                                    </p>
                                    <p style='margin-left: 72.0pt;'>
                                        o&nbsp;
本地化资源
                                    </p>
                                    <p style='margin-left: 72.0pt;'>
                                        o&nbsp;
XAML 控件
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
因为调用了托管运行时，因此启动时间可能稍慢一些，而且会使用少量额外内存。除 XAML 控件无效而需重绘的情况，与纯本机应用相比，可忽略 托管的应用 的性能下降。
                                    </p>
                                    <p>可使用 XAML 提供完整 UI 以创建游戏。但是，也可以创建托管游戏，它使用 Direct3D 将 3D 图形呈现至屏幕。此类应用有两种特殊的项目模板。</p>
                                    <h4>2.1.1.1 XAML 和 Direct3D 项目模板</h4>
                                    <p>
                                        如果想在 XAML UI 内呈现 3D 图形，则建议使用该模板。该模板使用
                                <a
                                    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.windows.controls.drawingsurface(v=vs.105).aspx">DrawingSurface</a> 控件在屏幕上显示 Direct3D 图形。<a
                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.windows.controls.drawingsurface(v=vs.105).aspx">DrawingSurface</a> 与其他任何 XAML 控件一样，可以被放置在屏幕上的任何位置，在其他 XAML 控件上方或旁边都可以。在单独的 Windows
Phone 运行时
组件内实现通常用于呈现图形的
Direct3D 代码。
                                    </p>
                                    <h4>2.1.1.2 Direct3D 和 XAML 项目模板</h4>
                                    <p>
                                        如果想创建的游戏只将托管应用作为围绕实质上的本机游戏的精简包装使用，以便利用仅
托管的应用 可用的一些功能（如实时拼贴），则建议使用该模板。该模板使用 <a
    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.windows.controls.drawingsurfacebackgroundgrid(v=vs.105).aspx">DrawingSurfaceBackgroundGrid</a> 控件在屏幕上显示 Direct3D 图形。与 <a
        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.windows.controls.drawingsurface(v=vs.105).aspx">DrawingSurface</a> 控件不同，该控件必须置于 XAML 树的根部，而且总是覆盖整个屏幕。与另一个模板一样，在单独的 Windows Phone
运行时
组件内实现用于呈现图形的
Direct3D 代码。Direct3D 和 XAML 应用的帧速率仅稍微优于 XAML 和 Direct3D 应用。
                                    </p>
                                    <h3><a name="_Toc372636869">2.1.2 </a>Direct3D 应用</h3>
                                    <p>
                                        完全用本机代码编写 Direct3D 应用。一般的开发人员可能发现，开发 Direct3D 应用
比开发可比的 托管的应用 更具挑战性，因为必须使用本机代码从头实现 托管的应用 可用的许多功能（表现为可靠的高级托管 API
形式）。对于 UI 组件来说尤其如此，因为它们没有纯本机应用可用的预制按钮、列表或文本框控件（虽然第三方库可能提供这其中部分内容）。高级开发人员和以多个平台为目标的开发人员可能发现可以更轻松、更灵活地使用这种项目类型。以下是 Direct3D 应用 的一些功能。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
项目模板 - 通过在新建项目对话中创建新项目并选择 Templates-&gt;Visual
C++ 下的 Direct3D 应用程序项目模板，可以在
Visual Studio 中创建 Direct3D 应用。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
应用模型 - Direct3D 应用 应用程序模型反映 Windows&nbsp;8 设计原则。该模型使用 CoreApplication 对象，该对象管理应用程序生命周期事件，然后将它们分发至
IFrameworkView 界面的实现。该界面公开承载您的游戏循环的 Run 方法。在该模型中，没有内置的导航概念。您只需根据应用需要，拖至屏幕。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
UI
- Direct3D 应用
不支持 XAML 或任何内置控件。如果您的应用需要标准控件，如文本框、按钮或复选框，那么您需要从头编写它们，或使用第三方库。
                                    </p>
                                    <h3><a name="_Toc372636870">2.1.3 </a>何种应用程序模型适合您的应用？</h3>
                                    <p>
                                        <b>托管</b> - 托管的应用 的 UI 框架（包含控件和页面导航）意味着应用程序开发更快速、更易用。对 Windows
Phone 运行时 库（<a
    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.windows.controls.drawingsurface(v=vs.105).aspx">DrawingSurface</a> 控件）的访问让您可以使用 Direct3D 将图形呈现为 XAML 页面，而可以从托管代码调用本机程序集的能力意味着与仅限本机的应用相比，托管的应用
拥有相当的功能或性能。多个有用功能，如实时拼贴、后台传输服务和几个内置启动器和选择器，只能在 托管的应用 应用程序中使用。托管的应用 应用也将让您可以复用 Windows Phone OS 7.1 应用程序中的大多数代码。
                                    </p>
                                    <p>
                                        <b>Direct3D</b> - Direct3D
应用 面向具有最高性能要求的应用，如复杂的 3D 游戏。没有内置控件或其他用户界面基元。纯本机应用程序更易于导至
Windows&nbsp;8 本机应用程序和其他支持本机代码的平台。
                                    </p>
                                    <p>
                                        有关创建 Direct3D 应用 的更多信息，请参见 <a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/jj207052(v=vs.105).aspx">Windows
Phone 8 的 Direct3D 应用开发</a>。
                                    </p>
                                    <h2><a name="_Toc372636871">2.2 Windows Phone 8 的 Direct3D</a></h2>
                                    <h3><a name="_Toc372636872">2.2.1 手机和桌面游戏开发之间的差别</a></h3>
                                    <h4>2.2.1.1 Direct3D API</h4>
                                    <p>
                                        Windows
Phone 8 支持 DirectX 库中 API 的子集。最值得注意的是，Windows 映射处理组件 (WIC) 和 Direct2D 库完全不受支持。手机上支持的 API 在 9_3 功能级别上受支持，这意味着与支持更高功能级别的设备上运行的相同 API 相比，这些 API 有不同的表现。下面是一些示例，其中在使用 9_3 功能级别时，尤其是在为图形设备设置交换链时，API 在手机上的行为与其在桌面应用中的行为不同。有关手机上 Direct3D 的 API 差异的详细信息，请参见 <a
    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/jj207010(v=vs.105).aspx">Supported
Direct3D APIs for Windows Phone</a>。
                                    </p>
                                    <h4>2.2.1.2 加载纹理</h4>
                                    <p>
                                        Windows
8 应用可以使用 WIC 以多种图像格式（如 PNG 文件）加载纹理。Windows Phone 不支持 WIC。面向手机的游戏应该使用 .dds 文件格式的纹理。
                                    </p>
                                    <p>由于手机屏幕较小，建议您对手机游戏使用较小的纹理。这不会改进性能，但这能够使应用的 XAP 文件显著缩小且不会影响游戏的视觉保真度。</p>
                                    <h4>2.2.1.3 绘制 2-D 图形</h4>
                                    <p>
                                        Windows&nbsp;8
应用可以使用 Direct2D 将 2-D 图形呈现到屏幕。呈现 GUI 组件（如，菜单和 HUD）就是典型的例子。面向手机的游戏应该使用 Direct3D 模拟二维 sprite 的行为，来绘制使用纹理的并与屏幕对齐的四边形。
                                    </p>
                                    <h4>2.2.1.4 输入</h4>
                                    <p>
                                        Windows
Phone 不支持游戏手柄或硬件键盘输入。使用 Windows 8 上用于鼠标输入的 <a
    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/windows.ui.core.corewindow.pointerpressed.aspx">PointerPressed</a>、<a
        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/windows.ui.core.corewindow.pointerreleased.aspx">PointerReleased</a>
                                        和 <a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/windows.ui.core.corewindow.pointermoved.aspx">PointerMoved</a> 处理触控输入。
                                    </p>
                                    <h4>2.2.1.5 文本输入</h4>
                                    <p>
                                        在 Windows Phone 上，术语“Direct3D 应用”是指使用本机应用模型并且仅可调用本机代码的应用。此类型的应用不支持任何 XAML 控件，如用于文本输入的文本框。有一些帮助器功能允许本机应用从软件输入面板
(SIP) 键盘接收文本输入，以启用自定义生成的文本框。有关在本机应用中处理文本输入的更多信息，请参见<a
    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/jj247546(v=vs.105).aspx">如何在 Windows
Phone 8 的 Direct3D 应用中处理键盘输入</a>。
                                    </p>
                                    <h4>2.2.1.6 后台音频</h4>
                                    <p>
                                        Windows
Phone 重新实现桌面上提供的 Microsoft 媒体基础 (MF) API 的子集。您应该使用 IMFMediaEngine 接口为游戏实现后台音频。有关手机上支持的 MF 接口的更多信息，请参见
                                <a
                                    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/jj207074(v=vs.105).aspx">演练：使用 Windows
Phone 8 的 Microsoft 媒体基础</a>。
                                    </p>
                                    <h4>2.2.1.7 Windows Phone 8 的大理石迷宫示例</h4>
                                    <p>
                                        大理石迷宫是一款功能全面的游戏，是为说明 Windows 商店 应用的游戏开发而开发。有关如何开发该游戏的信息，请参见<a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/br230257.aspx">开发大理石迷宫</a>。该应用已经被移植在 Windows Phone 8 上运行。若要下载示例和阅读为使之在 Windows Phone
上运行而做出的更改，请参见 <a
    href="http://go.microsoft.com/fwlink/p/?LinkId=269990">Windows Phone 8 的大理石迷宫示例</a>。
                                    </p>
                                    <h4>2.2.1.8 DirectX 工具包</h4>
                                    <p>
                                        DirectX
工具包 (DirectXTK) 是用于编写 Direct3D 11 代码的帮助器类的集合。DirectXTK 既支持桌面开发，也支持手机开发，而且可以帮助您实现一些在手机上可能挑战性更强的常见方案，如加载纹理、二维绘制和呈现文本。该工具箱的功能包括：
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        1. SpriteBatch
- 简单而有效的 2-D sprite 呈现
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        2. SpriteFont
- 基于位图的文本呈现
                                    </p>
                                    <p style='margin-left: 36.0pt;'>3. Effects - 用于常见呈现任务的内置着色器集</p>
                                    <p style='margin-left: 36.0pt;'>
                                        4. PrimitiveBatch
- 简单而有效的绘制用户基元的方式
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        5. GeometricPrimitive
- 绘制基本形状，如立方体和球体。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        6. CommonStates
- 提供常用的 Direct3D 状态对象的工厂
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        7. VertexTypes
- 用于常用的顶点数据格式的结构
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        8. DDSTextureLoader
- 轻量 DDS 文件纹理加载器
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        9. WICTextureLoader
- 基于 WIC 的图像文件纹理加载器（Windows&nbsp;Phone&nbsp;8 不支持它）
                                    </p>
                                    <p style='margin-left: 36.0pt;'>10.&nbsp; ScreenGrab - 轻量屏幕快照保存器</p>
                                    <p>
                                        有关 DirectXTK 的更多信息，请参见 <a
                                            href="http://go.microsoft.com/fwlink/p/?LinkId=248929">CodePlex</a> 上的项目页面。
                                    </p>
                                    <h3><a name="_Toc372636873">2.2.2 Windows Phone 8 的 Direct3D 功能级别 9_3</a></h3>
                                    <table>
                                        <tr>
                                            <td>
                                                <p style='text-align: center'><b>功能</b></p>
                                            </td>
                                            <td>
                                                <p style='text-align: center'><b>功能级别 9_3 的支持</b></p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>着色器型号</p>
                                            </td>
                                            <td>
                                                <p>2.0 (4_0_level_9_3) [vs_2_a/ps_2_b]</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb205146.aspx">几何图形着色器</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>否</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb205121.aspx">流输出</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>否</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476331(v=vs.105).aspx">并行计算 / 计算着色器</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>N/A</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476340(v=vs.105).aspx">外壳和域着色器</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>否</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476906(v=vs.105).aspx">纹理资源数组</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>否</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476906(v=vs.105).aspx">立方体贴图资源数组</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>否</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb694531.aspx">BC4/BC5
  压缩</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>否</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/hh308955(v=vs.105).aspx">BC6H/BC7
  压缩</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>否</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb205072.aspx">Alpha 至覆盖</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>否</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/en-us/library/windows/desktop/ff476874.aspx">扩展格式（如，BGRA）</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>是</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/en-us/library/windows/desktop/ff476874.aspx">10-位 XR 高颜色格式</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>N/A</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/hh404457(v=vs.105).aspx">逻辑操作（输出合并器）</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>否</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>独立于目标的光栅化</p>
                                            </td>
                                            <td>
                                                <p>否</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    具有
  ForcedSampleCount1 的多个呈现目标 (MRT)
                                                </p>
                                            </td>
                                            <td>
                                                <p>否</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    UAV
  插槽
                                                </p>
                                            </td>
                                            <td>
                                                <p>N/A</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>每个阶段的 UAV</p>
                                            </td>
                                            <td>
                                                <p>N/A</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>仅限 UAV 呈现的最高强制采样计数</p>
                                            </td>
                                            <td>
                                                <p>N/A</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>恒缓冲抵消和部分更新</p>
                                            </td>
                                            <td>
                                                <p>是</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    16
  位每像素 (bpp) 格式
                                                </p>
                                            </td>
                                            <td>
                                                <p>可选</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>最大纹理维度</p>
                                            </td>
                                            <td>
                                                <p>4096</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>最大立方体贴图维度</p>
                                            </td>
                                            <td>
                                                <p>4096</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>最大体积扩展</p>
                                            </td>
                                            <td>
                                                <p>256</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>最大纹理重复</p>
                                            </td>
                                            <td>
                                                <p>8192</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>最大各向异性</p>
                                            </td>
                                            <td>
                                                <p>16</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>最大基元计数</p>
                                            </td>
                                            <td>
                                                <p>1048575</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>最大输入插槽</p>
                                            </td>
                                            <td>
                                                <p>16</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>同步呈现目标</p>
                                            </td>
                                            <td>
                                                <p>4</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>封闭查询</p>
                                            </td>
                                            <td>
                                                <p>是</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>单独的 alpha 混合</p>
                                            </td>
                                            <td>
                                                <p>是</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>镜像一次</p>
                                            </td>
                                            <td>
                                                <p>是</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>顶点元素重叠</p>
                                            </td>
                                            <td>
                                                <p>是</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>独立写入掩码</p>
                                            </td>
                                            <td>
                                                <p>是</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>实例化</p>
                                            </td>
                                            <td>
                                                <p>是</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    Nonpowers-of-2
  纹理
                                                </p>
                                            </td>
                                            <td>
                                                <p>
                                                    对于功能级别 9_3，在两种条件下显示设备支持使用其维度不是 2 的幂的二维纹理。首先，仅可以为每个纹理创建一个 MIP-地图级别；第二，不允许纹理的包装采样器模式（即，不能将
  D3D11_SAMPLER_DESC 的 AddressU、AddressV 和 AddressW
  成员设置为
  D3D11_TEXTURE_ADDRESS_WRAP）。
                                                </p>
                                            </td>
                                        </tr>
                                    </table>
                                    <br />
                                    <h3><a name="_Toc372636874">2.2.3 Windows Phone 8 的着色器模型支持</a></h3>
                                    <p>
                                        在 Windows
Phone 8 上，开发人员可以在使用 Direct3D 的应用中使用自定义顶点着色器和像素着色器。Windows&nbsp;Phone&nbsp;8
设备上的自定义着色器的受支持功能和限制由着色器模型
4_0_level_9_3 定义。有关着色器模型的更多信息，请参见<a
    href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb509626(v=vs.85).aspx">着色器模型 vs. 着色器配置文件</a>。
                                    </p>
                                    <p>
                                        4_0_level_9_3
着色器模型包含 Direct3D
9-era 着色器模型 2.0 的所有功能，同时带有一些重要差异。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
对于 DirectX，必须使用高级着色语言编写着色器。有关更多信息，请参见 <a
    href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb509561(v=vs.85).aspx">HLSL</a>。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
支持静态和动态流控制。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
顶点着色器在长度上可能相当于 256 个相等的着色器汇编程序指令。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
像素着色器在长度上可能相当于 512 个相等的着色器汇编程序指令。
                                    </p>
                                    <p>
                                        HLSL
是为编写 GPU 着色器代码而优化的像 C 一样的编程语言。当用 HLSL 为
Windows&nbsp;Phone&nbsp;8 应用编写着色器代码时，您应考虑以下内容：
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
必须使用 FXC.exe（效果编译器工具）脱机编译着色器代码。Visual Studio 默认使用它，也可以从命令行调用它。不支持运行时着色器编译。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
4_0_level_9_3
的着色器编译器目标是针对顶点着色器的 vs_4_0_level_9_3 和针对像素着色器的 ps_4_0_level_9_3。有关着色器编译器目标的更多信息，请参见<a
    href="http://msdn.microsoft.com/en-us/library/windows/desktop/jj215820(v=vs.85).aspx">指定编译器目标</a>。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
4_0_level_9_3
着色器模型的语义与为 Direct3D 9 编写的语义相同，因此大多数系统价值语义（通过 Direct3D
10 和着色器模型 4.0 引入）都不可用。SV_Position、SV_Target 和 SV_Depth 是例外，它们都受支持。有关语义的更多信息，包括系统价值语义，请参见<a
    href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb509647(v=vs.85).aspx">语义</a>。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        ●
在编写可能接近指令计数限制的较大着色器的情况下，当编译着色器以获取和检查产生的汇编程序代码输出时，您可以使用“/Fc”进行切换。有关效果编译器工具的命令行选项的更多信息，请参见<a
    href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb509709(v=vs.85).aspx">语法</a>。
                                    </p>
                                    <h3><a name="_Toc372636875">2.2.4 为 Windows Phone 8 创建 Direct3D 设备和交换链</a></h3>
                                    <h4>2.2.4.1 创建 Direct3D 设备</h4>
                                    <p>
                                        <a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476379(v=vs.105).aspx">ID3D11Device</a> 是
Direct3D 开发的重要界面。它用于创建您将用到的大多数其他图形资源，如纹理、顶点缓冲区和着色器。创建该设备的代码位于 Direct3Dbase 类的 CreateDeviceResources 方法中的 Direct3D 应用项目模板内。
                                    </p>
                                    <p>C++<a name="CodeSnippetCopyLink"></a></p>
                                    <pre><code>D3D_FEATURE_LEVEL featureLevels[] = 
	{
		D3D_FEATURE_LEVEL_11_1,
		D3D_FEATURE_LEVEL_11_0,
		D3D_FEATURE_LEVEL_10_1,
		D3D_FEATURE_LEVEL_10_0,
		D3D_FEATURE_LEVEL_9_3
	};
	// Create the Direct3D 11 API device object and a corresponding context.
	ComPtr<ID3D11Device> device;
	ComPtr<ID3D11DeviceContext> context;
	DX::ThrowIfFailed(
		D3D11CreateDevice(
			nullptr, // Specify nullptr to use the default adapter.
			D3D_DRIVER_TYPE_HARDWARE,
			nullptr,
			creationFlags, // Set set debug and Direct2D compatibility flags.
			featureLevels, // List of feature levels this app can support.
			ARRAYSIZE(featureLevels),
			D3D11_SDK_VERSION, // Always set this to D3D11_SDK_VERSION.
			&device, // Returns the Direct3D device created.
			&m_featureLevel, // Returns feature level of device created.
			&context // Returns the device immediate context.
			)
		);
	// Get the Direct3D 11.1 API device and context interfaces.
	DX::ThrowIfFailed(
		device.As(&m_d3dDevice)
		);
	DX::ThrowIfFailed(
		context.As(&m_d3dContext)
		);</code></pre>
                                    <p>
                                        请注意，featureLevels 数组包含的常数列表代表特定设备可能支持的不同设备功能级别。对 <a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476082(v=vs.105).aspx">CreateD3D11Device</a> 的调用将为当前设备所支持的数组中的第一个功能级别创建设备。Windows&nbsp;Phone 仅支持功能级别 9_3，因此这是在物理设备上运行时，唯一会被返回的设备。但是，Windows Phone 8 模拟器 可能允许创建功能级别更高的设备。不论您是在设备上还是模拟器上运行应用，为了确保您用正确的功能级别测试应用，建议您更新代码，以便只请求功能级别 9_3。要实现这一点，则将 featureLevels 数组更改为如下所示。
                                    </p>
                                    <p>C++</p>
                                    <pre><code>D3D_FEATURE_LEVEL featureLevels[] = 
	{
		D3D_FEATURE_LEVEL_9_3
	};</code></pre>
                                    <p>
                                        有关功能级别 9_3 支持的更多信息，请参见<a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/jj714085(v=vs.105).aspx">Windows
Phone 8 的 Direct3D 功能级别
9_3</a>。
                                    </p>
                                    <h4>2.2.4.2 创建交换链</h4>
                                    <p>
                                        Direct3D
应用使用交换链将后台缓冲区的内容复制到屏幕。使用
                                <a
                                    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/hh404556(v=vs.105).aspx">IDXGIFactory2</a> 接口创建交换链。手机仅支持该接口公开的方法的子集。有关受支持的 API 的完整列表，请参见 <a
                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/jj207010(v=vs.105).aspx">Supported
Direct3D APIs for Windows Phone</a>。
                                    </p>
                                    <p>
                                        除了一些 DXGI 方法在手机上完全不可用的事实之外，Windows&nbsp;Phone&nbsp;8
上的 DXGI 也展现出受支持的 API 的一些关键差异，主要涉及交换链的创建及其相关后台缓冲区与 IDXGIFactory2::CreateSwapChainForCoreWindow 之间的内容。以下列表指出这些关键差异：
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        1. DXGI_SWAP_CHAIN_DESC1.Format
- 在 Windows&nbsp;Phone&nbsp;8 上，唯一支持的显示格式是
DXGI_FORMAT_B8G8R8A8_UNORM。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        2. DXGI_SWAP_CHAIN_DESC1.BufferCount
- 在 Windows&nbsp;Phone&nbsp;8 上，交换链的缓冲区数必须为 1。如果指定的值大于 1，DXGI 将默认为 1。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        3. DXGI_SWAP_CHAIN_DESC1.SwapEffect
- 在 Windows&nbsp;Phone&nbsp;8 上，唯一支持的交换效果是
DXGI_SWAP_EFFECT_DISCARD。这意味着，DXGI 将不会在表示之后保留后台缓冲区的内容。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        4. DXGI_SWAP_CHAIN_DESC1.Scaling
- 在 Windows&nbsp;Phone&nbsp;8 上，支持的缩放模式仅有
DXGI_SCALING_STRETCH 和 DXGI_SCALING_ASPECT_RATIO_STRETCH。当后台缓冲区的大小与目标输出不相等时，DXGI_SCALING_STRETCH 将缩放后台缓冲区内容，使之适合目标输出（不考虑纵横比），而 DXGI_SCALING_ASPECT_RATIO_STRETCH 将根据需要执行纵横比保留缩放和 letterbox 内容。
                                    </p>
                                    <p>以下代码显示 Direct3D 应用项目模板中的交换链创建。</p>
                                    <p>C++</p>
                                    <pre><code>m_windowBounds = m_window->Bounds;
	// Calculate the necessary swap chain and render target size in pixels.
	m_renderTargetSize.Width = ConvertDipsToPixels(m_windowBounds.Width);
	m_renderTargetSize.Height = ConvertDipsToPixels(m_windowBounds.Height);
	DXGI_SWAP_CHAIN_DESC1 swapChainDesc = {0};
	swapChainDesc.Width = static_cast<UINT>(m_renderTargetSize.Width); // Match the size of the window.
	swapChainDesc.Height = static_cast<UINT>(m_renderTargetSize.Height);
	swapChainDesc.Format = DXGI_FORMAT_B8G8R8A8_UNORM; // This is the most common swap chain format.
	swapChainDesc.Stereo = false;
	swapChainDesc.SampleDesc.Count = 1; // Don't use multi-sampling.
	swapChainDesc.SampleDesc.Quality = 0;
	swapChainDesc.BufferUsage = DXGI_USAGE_RENDER_TARGET_OUTPUT;
	swapChainDesc.BufferCount = 1; // On phone, only single buffering is supported.
	swapChainDesc.Scaling = DXGI_SCALING_STRETCH; // On phone, only stretch and aspect-ratio stretch scaling are allowed.
	swapChainDesc.SwapEffect = DXGI_SWAP_EFFECT_DISCARD; // On phone, no swap effects are supported.
	swapChainDesc.Flags = 0;
	ComPtr<IDXGIDevice1> dxgiDevice;
	DX::ThrowIfFailed(
		m_d3dDevice.As(&dxgiDevice)
		);
	ComPtr<IDXGIAdapter> dxgiAdapter;
	DX::ThrowIfFailed(
		dxgiDevice->GetAdapter(&dxgiAdapter)
		);
	ComPtr<IDXGIFactory2> dxgiFactory;
	DX::ThrowIfFailed(
		dxgiAdapter->GetParent(
			__uuidof(IDXGIFactory2), 
			&dxgiFactory
			)
		);
	Windows::UI::Core::CoreWindow^ window = m_window.Get();
	DX::ThrowIfFailed(
		dxgiFactory->CreateSwapChainForCoreWindow(
			m_d3dDevice.Get(),
			reinterpret_cast<IUnknown*>(window),
			&swapChainDesc,
			nullptr, // Allow on all displays.
			&m_swapChain
			)
		);</code></pre>
                                    <h3><a name="_Toc372636876">2.2.5 在 Windows Phone 8 的 Direct3D 中启用抗锯齿</a></h3>
                                    <p>
                                        Window
Phone 8 在后台缓冲区图面上不支持多示例抗锯齿 (MSAA)。该限制在所有的 Windows Phone 8 应用程序和所有的 Windows 商店 应用程序中都存在。如果您在 Windows Phone 启用 MSAA 的情况下，尝试创建交换链，那么 DXGI 将返回 DXGI_ERROR_INVALID_CALL。
                                    </p>
                                    <p>但是，因为该限制仅适用于后台缓冲区，而不适用于常规的屏幕外呈现目标，所以使用次级呈现目标来为您的应用程序启用 MSAA 仍有可能。为此，您必须执行下列步骤：</p>
                                    <p style='margin-left: 36.0pt;'>
                                        1. 在启用了多重采样和设置了呈现目标绑定标志的情况下，创建新的
                                <a
                                    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476635(v=vs.105).aspx">ID3D11Texture2D</a>。这是您的屏幕外呈现目标纹理。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>
                                        2. 为您新建的呈现目标纹理创建 <a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476582(v=vs.105).aspx">ID3D11RenderTargetView</a>。
                                    </p>
                                    <p style='margin-left: 36.0pt;'>3. 将您的场景绘制至您的呈现目标。</p>
                                    <p style='margin-left: 36.0pt;'>
                                        4. 将您的呈现目标作为源，将后台缓冲区作为目的地，调用
                                <a
                                    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476474(v=vs.105).aspx">ID3D11DeviceContext::ResolveSubresource</a>。
                                    </p>
                                    <p>
                                        请注意，并非所有纹理格式都支持 MSAA。关于在功能级别 9_3 设备（如 Windows&nbsp;Phone）上支持多示例抗锯齿的呈现目标格式列表，请参见 <a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff471324(v=vs.105).aspx">Direct3D
10Level9 格式的硬件支持</a>。
                                    </p>
                                    <h4>2.2.5.1 修改 Direct3D 应用项目模板以使用抗锯齿</h4>
                                    <p>以下步骤向您演示如何使用屏幕外缓冲区修改包括在 Windows Phone SDK 8.0 中的 Direct3D 应用模板，以支持抗锯齿。</p>
                                    <p>首先，在 Direct3Dbase.h 中声明新的 Texture2D 的变量，把它们作为屏幕外缓冲区，同时声明 RenderTargetView，使用纹理作为呈现对象时需要用它。另外，创建成员变量以存储主要后台缓冲区。在默认模板中，该变量是本地的，将会超出范围，但是在这种情况，我们以后需要引用它。</p>
                                    <p>C++</p>
                                    <pre><code>Microsoft::WRL::ComPtr<ID3D11Texture2D> m_backBuffer;
	Microsoft::WRL::ComPtr<ID3D11Texture2D> m_offscreenRenderTarget;
	Microsoft::WRL::ComPtr<ID3D11RenderTargetView> m_offscreenRenderTargetView;</code></pre>
                                    <p>
                                        在 Direct3Dbase.cpp 中，在
CreateWindowSizeDependentResources 方法的底部，添加以下代码以创建呈现目标和呈现目标视图。将 desc.SampleDesc.Count 设置为 4，则将通过 4x 多重取样创建纹理。
                                    </p>
                                    <p>C++</p>
                                    <pre><code>CD3D11_TEXTURE2D_DESC desc(DXGI_FORMAT_B8G8R8A8_UNORM, m_renderTargetSize.Width, m_renderTargetSize.Height, 1, 1);
		desc.BindFlags = D3D11_BIND_RENDER_TARGET;
		desc.SampleDesc.Count = 4; // 4x MSAA
		DX::ThrowIfFailed(
			m_d3dDevice->CreateTexture2D(
				&desc,
				nullptr,
				&m_offscreenRenderTarget
				)
			);
		DX::ThrowIfFailed(
			m_d3dDevice->CreateRenderTargetView(
				m_offscreenRenderTarget.Get(),
				nullptr,
				&m_offscreenRenderTargetView
				)
			);</code></pre>
                                    <p>
                                        接下来在 CreateWindowSizeDependentResources 中，您应对通过与呈现目标相同的多重取样级别而创建深度模板的代码进行修改。在本代码中，默认模板中被更改的行是 depthStencilDesc.SampleDesc.Count 设置为 4 的行和使用 D3D11_DSV_DIMENSION_TEXTURE2DMS 常量初始化
depthStencilViewDesc 变量的行。模板默认使用不启用多重取样的
D3D11_DSV_DIMENSION_TEXTURE2D
                                    </p>
                                    <p>C++</p>
                                    <pre><code>// Create a depth stencil view.
	CD3D11_TEXTURE2D_DESC depthStencilDesc(
		DXGI_FORMAT_D24_UNORM_S8_UINT,
		static_cast<UINT>(m_renderTargetSize.Width),
		static_cast<UINT>(m_renderTargetSize.Height),
		1,
		1,
		D3D11_BIND_DEPTH_STENCIL
		);
	depthStencilDesc.SampleDesc.Count = 4; // 4x MSAA
	ComPtr<ID3D11Texture2D> depthStencil;
	DX::ThrowIfFailed(
		m_d3dDevice->CreateTexture2D(
			&depthStencilDesc,
			nullptr,
			&depthStencil
			)
		);
	CD3D11_DEPTH_STENCIL_VIEW_DESC depthStencilViewDesc(D3D11_DSV_DIMENSION_TEXTURE2DMS);
	DX::ThrowIfFailed(
		m_d3dDevice->CreateDepthStencilView(
			depthStencil.Get(),
			&depthStencilViewDesc,
			&m_depthStencilView
			)
		);</code></pre>
                                    <p>同样在 CreateWindowSizeDependentResources 中，您需要更新创建了后台缓冲区的代码，以使用 m_backBuffer 成员变量而非模板中使用的本地后台缓冲区变量。</p>
                                    <p>C++</p>
                                    <pre><code>// Create a render target view of the swap chain back buffer.
	DX::ThrowIfFailed(
		m_swapChain->GetBuffer(
			0,
			__uuidof(ID3D11Texture2D),
			&m_backBuffer
			)
		);
	DX::ThrowIfFailed(
		m_d3dDevice->CreateRenderTargetView(
			m_backBuffer.Get(),
			nullptr,
			&m_renderTargetView
			)
		);</code></pre>
                                    <p>现在，只剩下修改 CubeRenderer.cpp 中的“呈现”方法，以使用屏幕外的呈现目标。在该方法的顶部，添加以下代码以设置呈现目标。</p>
                                    <p>C++</p>
                                    <pre><code>const float midnightBlue[] = { 0.098f, 0.098f, 0.439f, 1.000f };
	m_d3dContext->ClearRenderTargetView(
		m_offscreenRenderTargetView.Get(),
		midnightBlue
		);
	m_d3dContext->OMSetRenderTargets(
		1,
		m_offscreenRenderTargetView.GetAddressOf(),
		m_depthStencilView.Get()
		);</code></pre>
                                    <p>最后，在“呈现”方法的末尾，调用 ResolveSubresources 以便将呈现目标的内容复制到后台缓冲区。</p>
                                    <p>C++</p>
                                    <pre><code>m_d3dContext->ResolveSubresource(
		m_backBuffer.Get(),
		0,
		m_offscreenRenderTarget.Get(),
		0,
		DXGI_FORMAT_B8G8R8A8_UNORM);</code></pre>
                                    <h3><a name="_Toc372636877">2.2.6 优化 Windows Phone 8 基于图块的呈现</a></h3>
                                    <p>
                                        Windows
Phone 8 设备使用的 GPU 利用基于图块的呈现方法。该呈现方法针对非常占用内存的呈现操作利用内部图块缓存，避免否则会需要到的许多片外内存交易，力图提高 GPU 性能和减少耗电量。从概念上说，基于图块的呈现涉及将呈现目标划分为图块缓存大小的块，即图块，而且要多次重播定向在呈现目标的呈现命令，每次一个图块。基于图块的 GPU 的驱动程序可以敏捷地确定在给定图块上需要呈现哪些顶点，在必要的地方剪裁三角形和线段，以及使用“binning”进程。但是，对于该驱动程序来说，为含有多重或复合呈现目标的应用程序方案优化图块呈现的挑战性更大，这主要因为它并不一定知道应用程序何时完成当前呈现目标的图块。在默认情况下，移至新的呈现目标图块时，驱动程序将保留图块内容，即在加载下一个图块之前将此图块解析回至内存，这可能引起不必要的内存开销。
                                    </p>
                                    <p>
                                        基于图块的 GPU 的图块缓存结构得到高度优化，以便非常高效地从事缓存内图形内存交易。例如，Alpha
混合实际上有意不占用基于图块的 GPU，而如果使用传统 GPU，则会因所需的与外部图像内存之间的读-修改-写交易而产生额外开销。类似地，多示例抗锯齿 (MSAA) 呈现目标对基于图块的 GPU 的开销大大小于对传统 GPU 的，这仍然得益于经优化的图块缓存结构。
                                    </p>
                                    <p>
                                        Direct3D11
(D3D 11) 包含一些 API，这些 API 让应用程序能够向
GPU 驱动程序提供提示，帮助驱动程序避免与图块相关的不必要内存交易。在以下部分，将在常见应用程序方案和基于图块的呈现上下文中解释现有的和新的 D3D 11.1 GPU 提示 API。
                                    </p>
                                    <h4>2.2.6.1 避免中途切换呈现目标</h4>
                                    <p>通常，为了避免不必要的图块解析和涉及的性能损失，采用多个呈现目标的应用程序应在为给定场景处理完一个呈现目标后再处理下一个。例如，采用一个或多个屏幕外呈现目标（在为当前帧呈现缓冲区时对呈现目标生成的纹理进行采样）的应用，应在向后备缓冲区呈现之前完成每一个纹理的呈现。</p>
                                    <h4>2.2.6.2 避免“增量呈现”</h4>
                                    <p>对于要组合多个纹理层的应用程序方案，应避免增量合并，以避免“增量呈现”，“增量呈现”涉及会损害性能的不必要的外部内存交易和不必要的 D3D11 调用。例如，考虑一下增量合并 4 个纹理层而不是推迟合并的后果：</p>
                                    <table>
                                        <tr>
                                            <td>
                                                <p style='text-align: center'><b>首选方法</b></p>
                                            </td>
                                            <td>
                                                <p style='text-align: center'><b>低效方法</b></p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p style='margin-left: 36.0pt;'>1.&nbsp; 设置呈现对象 A、清理 A、绘制至 A</p>
                                                <p style='margin-left: 36.0pt;'>2.&nbsp; 设置呈现对象 B、清理 B、绘制至 B</p>
                                                <p style='margin-left: 36.0pt;'>3.&nbsp; 设置呈现对象 C、清理 C、绘制至 C</p>
                                                <p style='margin-left: 36.0pt;'>4.&nbsp; 设置呈现对象 D、清理 D、使用 A、B 和 C 绘制至 D</p>
                                                <p>该方法需要 4 个调用来设置呈现目标。</p>
                                            </td>
                                            <td>
                                                <p style='margin-left: 36.0pt;'>1.&nbsp; 设置呈现对象 A、清理 A、绘制至 A</p>
                                                <p style='margin-left: 36.0pt;'>2.&nbsp; 设置呈现对象 D、清理 D、将 A 绘制至 D</p>
                                                <p style='margin-left: 36.0pt;'>3.&nbsp; 设置呈现对象 B、清理 B、绘制至 B</p>
                                                <p style='margin-left: 36.0pt;'>4.&nbsp; 设置呈现对象 D，将 B 绘制至 D</p>
                                                <p style='margin-left: 36.0pt;'>5.&nbsp; 设置呈现对象 C、清理 C、绘制至 C</p>
                                                <p style='margin-left: 36.0pt;'>6.&nbsp; 设置呈现对象 D，将 C 绘制至 D</p>
                                                <p>该方法需要 6 个调用来设置呈现目标。</p>
                                            </td>
                                        </tr>
                                    </table>
                                    <p>
                                        在以上所演示的首选方法中，请注意，切换至每一个呈现对象之后立即调用 Clear。这向 GPU 驱动程序指示，给定呈现对象不需要“增量呈现”，即不必在呈现之前读取每一个呈现目标图块。请在下一节中参阅 Clear 的替换项。在低效方法示例中，除了要更多地调用
OMSetRenderTarget，呈现目标 D 的图块还必须多次读回至内存。
                                    </p>
                                    <h4>2.2.6.3 避免不必要的清理</h4>
                                    <p>如果在一些方案中，应用程序提前知道现有呈现目标资源中的每一个像素都将被替代，即后续呈现操作中不需要它们，则两个新的“Discard”方法已被添加至 D3D 11.1，使之可以向 GPU 驱动程序指示该情况。以前该应用程序在此方案中有两个替换选项：</p>
                                    <p style='margin-left: 36.0pt;'>1. 在不清理的情况下绘制场景，这对于基于图块的 GPU 开销较大，因为 GPU 必须还原每一个图块，即在绘制前将每一个图块读入图块缓存中。显然，如果应用程序将不使用之前的内容，那么这些还原意味着大量的不必要开销。</p>
                                    <p style='margin-left: 36.0pt;'>2. 绘制前清理，这允许驱动程序避免还原图块，但却要求呈现目标写入操作执行 Clear 命令。同样，如果应用程序将不使用之前的内容，这些都不必要。</p>
                                    <p>新的 D3D 11.1 Discard 方法为应用程序提供更有效的第三种选择，如下表所示：</p>
                                    <table>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/hh404613(v=vs.105).aspx">ID3D11DeviceContext1::DiscardResource</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>不再定义向 GPU 指示资源当前内容和所有视图的信号，而且不需要在后续呈现通道上保留这些信号。</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <p>
                                                    <a
                                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/hh404616(v=vs.105).aspx">ID3D11DeviceContext1::DiscardView</a>
                                                </p>
                                            </td>
                                            <td>
                                                <p>从本质上说是与 DiscardResource 相同的操作，但是限定在特定的呈现目标视图中。</p>
                                            </td>
                                        </tr>
                                    </table>
                                    <p>请注意，一旦应用程序在呈现目标资源或视图上调用了 Discard，则 Draw 调用将在每个正被更新的像素中遵循该结果。Discard 之后的呈现目标内容未被定义，因此应用程序无法在它们上面执行 Alpha 混合或仅仅绘制被覆盖形状的部分。</p>
                                    <h4>2.2.6.4 避免不必要的中途刷新</h4>
                                    <p>
                                        中途调用 <a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476425(v=vs.105).aspx">ID3D11DeviceContext::Flush</a> 可能导致过早的图块解析，进而导致不必要的图块读取。有关更多信息，请参见
                                <a
                                    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476425(v=vs.105).aspx">ID3D11DeviceContext::Flush</a> 参考主题中的“备注”一节。
                                    </p>
                                    <h4>2.2.6.5 复制和更新时使用提示</h4>
                                    <p>
                                        如果应用提前知道只有限定范围的呈现目标部分将为给定场景更新，则应用应使用
                                <a
                                    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff476478(v=vs.105).aspx">ID3D11DeviceContext::RSSetScissorRects</a> 方法，使
GPU 驱动程序可以提前确定哪些图块不需要处理。
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="textlist">
                            另两篇文章：<br />
                            <ul>
                                <li><a href="design_06.html">多平台游戏渲染开发</a>
                                <li><a href="design_061.html">如何在WP8上搭建cocos2d-x的游戏开发环境</a>
                            </ul>
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>
            </div>
        </div>
        <!--End Content-->
        <div style="text-align: right" class="gotoTop"><a href="javascript:scroll(0,0)"></a></div>
        <!--Begin ProudctLinks-->
        <div class="ms-pro-links">
            <div class="grid-container clearfix">
                <div class="cam-links">
                    其它微软站点
                    <a href="http://www.microsoft.com/zh-cn/default.aspx">微软中国官方网站</a>
                    <a href="http://www.microsoft.com/zh-cn/download/default.aspx?WT.mc_id=MSCOM_zh-cn_HP_Footer_downloads" target="_blank">微软中国下载中心</a>
                    <a href="http://www.microsoftstore.com.cn?WT.mc_id=MSCOM_003" target="_blank">微软中国官方商城</a>
                    <a href="http://www.microsoft.com/china/newsletter/" target="_blank">订阅电子期刊</a>
                    <a href="https://sales.liveperson.net/hc/21661174/?cmd=file&file=visitorWantsToChat&site=21661174&byhref=1&SESSIONVAR!skill=APGC.PRC.ZH.CS.CON.PRESLS.GENERAL" target="_blank">联系微软销售代表</a>
                    <a href="http://www.microsoft.com/zh-cn/sitemap.aspx" target="_blank">网站地图</a>
                </div>
            </div>
        </div>
        <!--End ProudctLinks-->
        <!--Begin footer-->
        <div class="footer">
            <div class="grid-container">
                <img src="http://i.s-microsoft.com/global/ImageStore/PublishingImages/logos/hp/logo-type-1x.png" alt="microsoft" class="logo">
                <ul>
                    <li><a href="http://www.miibeian.gov.cn/" title="">京ICP备09042378号-6</a></li>
                    <li><a href="https://profile.microsoft.com/RegSysProfileCenter/default.aspx?lcid=2052" title="">个人信息中心</a></li>
                    <li><a href="http://support.microsoft.com/contactus/?ws=support" title="">与我们联系</a></li>
                    <li><a href="http://go.microsoft.com/fwlink/?LinkId=248681" title="">隐私权声明</a></li>
                    <li><a href="http://go.microsoft.com/?linkid=4412892" title="">使用条款</a></li>
                    <li><a href="http://www.microsoft.com/About/Legal/EN/US/IntellectualProperty/Trademarks/EN-US.aspx" title="">商标</a></li>
                    <li>&copy; 2013 Microsoft</li>
                </ul>
            </div>
        </div>
        <!--End footer-->
        <!-- Begin MDA WEDCS -->
        <script type="text/JavaScript">
            var varSegmentation = 0;
            var varClickTracking = 1;
            var varCustomerTracking = 1;
            var varAutoFirePV = 1;
            var Route = "#";
            var Ctrl = "#"
            //document.write("<script type='text/javascript' src='" + window.location.protocol + "//c.microsoft.com/ms.js'><"+"/script>");
        </script>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script type="text/javascript" src="./assets/js/script.js"></script>
        <script type="text/javascript" src="./js/siteSearch.js"></script>
        <noscript>
            <img alt="" width="1" height="1" src="http://c.microsoft.com/trans_pixel.aspx/" />
        </noscript>
        <!-- Begin MDA WEDCS -->
    </div>
</body>
</html>

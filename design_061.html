<!doctype html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>游戏开发: 如何在WP8上搭建cocos2d-x的游戏开发环境</title>
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="stylesheet" href="css/templete.css" type="text/css" media="all" />
    <meta charset="UTF-8">
</head>
<body class="level-2">
    <div class="wrapper">
        <!--Begin header-->
        <div class="header">
            <div class="grid-container clearfix">
                <div class="header-left">
                    <img alt="Microsoft" src="http://i.s-microsoft.com/global/ImageStore/PublishingImages/logos/hp/logo-lg-1x.png" width="94" height="20">
                    <h1>X-Platform</h1>
                </div>
                <div id="mscom-search" class="mscom-search" style="margin-top: 37px;">
                    <div class="search-form">
                        <form action="" id="search-form">
                            <div class="input-wrapper">
                                <label class="screen-reader-text" for="search-input">搜索 Microsoft.com</label>
                                <input id="search-input" type="text" class="input-area" autocomplete="off">
                            </div>
                            <button class="search-submit" id="search-btn" type="submit">
                                <img width="16" height="16" alt="Submit" src="http://i.s-microsoft.com/global/imagestore/PublishingImages/sprites/search-button-blue.png"></button>
                        </form>
                    </div>
                    <div class="search-results-box" id="results">
                        <div class="search-scope">
                            <ul>
                                <li class=""><a class="checked" search="microsoft" role="search">搜索 Microsoft.com</a></li>
                                <li class=""><a search="internet" role="search">搜索互联网</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--End header-->
        <br />
        <!--Begin Content-->
        <div class="content">
            <div class="wrapper">
                <div class="wrapper-header">
                    <div>
                        <a href="index.html">
                            <img src="./assets/image/banner_1.jpg"></a>
                    </div>
                </div>
                <div class="main">
                    <div class="nav">
                        <div class="block article-nav-block">
                            <h2>移动应用开发生命周期</h2>
                            <div class="menu">
                                <h3><a href="idea.html">计划<span>Idea/Planning</span></a></h3>
                                <ul>
                                    <li><a href="idea_01.html">平台总览</a></li>
                                    <li><a href="idea_02.html">开发工具、开发环境和模拟器</a></li>
                                    <li><a href="idea_03.html">应用结构和生命周期</a></li>
                                </ul>
                            </div>
                            <div class="menu active">
                                <h3><a href="design.html">设计<span>Design</span></a></h3>
                                <ul>
                                    <li><a href="design_01.html">UI Layout的设计</a></li>
                                    <li><a href="design_02.html">UI的控件</a></li>
                                    <li><a href="design_03.html">UI页面的控制和导航</a></li>
                                    <li><a href="design_04.html">不同屏幕尺寸和分辨率的适配</a></li>
                                    <li><a href="design_05.html">第三方SDK</a></li>
                                    <li><a href="design_06.html">游戏开发</a></li>
                                </ul>
                            </div>
                            <div class="menu">
                                <h3><a href="developing.html">开发<span>Developing</span></a></h3>
                                <ul>
                                    <li><a href="developing_01.html">开发语言</a></li>
                                    <li><a href="developing_02.html">Audio、Video Player应用的开发</a></li>
                                    <li><a href="developing_03.html">General APIs Mapping</a></li>
                                    <li><a href="developing_04.html">IAP应用内支付</a></li>
                                    <li><a href="developing_05.html">LBS应用</a></li>
                                    <li><a href="developing_06.html">LBS、镜头和传感器应用接口使用</a></li>
                                    <li><a href="developing_07.html">Native Code（C和C++）支持</a></li>
                                    <li><a href="developing_08.html">Push Notification</a></li>
                                    <li><a href="developing_09.html">Sharing in Social Network</a></li>
                                    <li><a href="developing_10.html">Source Code Control</a></li>
                                    <li><a href="developing_11.html">UI上的Data Binding</a></li>
                                    <li><a href="developing_12.html">Windows 8.1和WP 8 Sharing应用分享功能实现</a></li>
                                    <li><a href="developing_13.html">多媒体</a></li>
                                    <li><a href="developing_14.html">后台任务和多任务处理</a></li>
                                    <li><a href="developing_15.html">获取后台服务器数据</a></li>
                                    <li><a href="developing_16.html">浏览器控件WebView</a></li>
                                    <li><a href="developing_17.html">数据库（SQLite）</a></li>
                                    <li><a href="developing_18.html">数据网络和数据通讯</a></li>
                                    <li><a href="developing_19.html">通话和短信功能</a></li>
                                    <li><a href="developing_20.html">图形处理(Drawing & Animation)</a></li>
                                    <li><a href="developing_21.html">文件系统和应用设置</a></li>
                                    <li><a href="developing_22.html">应用间通信</a></li>
                                    <li><a href="developing_23.html">支付方式</a></li>
                                    <li><a href="developing_24.html">Windows 8.1应用外设开发</a></li>
                                </ul>
                            </div>
                            <div class="menu">
                                <h3><a href="testing.html">测试<span>Testing</span></a></h3>
                                <ul>
                                    <li><a href="testing_01.html">Windows 8 and WP 8开发FAQ</a></li>
                                </ul>
                            </div>
                            <div class="menu last">
                                <h3><a href="distribute.html">发布<span>Distribute</span></a></h3>
                                <ul>
                                    <li><a href="distribute_01.html">应用商店(发布和更新应用)</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="block success-story-nav-block">
                            <h2>成功案例</h2>
                        </div>
                        <div class="block others">
                            <a href="sample_code.html" class="left">示例代码</a>
                            <a href="http://msdn.microsoft.com/zh-cn/dn473954" class="right">教学视频</a>
                        </div>
                    </div>
                    <div class="content">
                        <div class="textlist">
                            游戏开发<br />
                            <ul>
                                <li><a href="design_06.html">多平台游戏渲染开发</a>
                                <li><a href="design_061.html">●如何在WP8上搭建cocos2d-x的游戏开发环境</a>
                                <li><a href="design_062.html">游戏开发框架</a>
                            </ul>
                        </div>
                        <h3 class="title">如何在WP8上搭建cocos2d-x的游戏开发环境<span><a href="index.html">返回首页&gt;</a></span></h3>
                        <div class="article-content">
                            <div class="WordSection1">
                                <p><span lang="EN-US"><strong>Overview</strong></span></p>
                                <p>
                                    Cocos2d-x 可能是目前最流行的2D手机游戏引擎，它是开源的
                                    Cocos2d-iphone项目的C++版本；支持多平台，包括iOS、Android、Windows Phone8、BlackBerry等，并还在不断更新和发展中；
                                </p>
                                <p>
                                    WP8是微软公司最新一代的手机操作系统，由于采用和Win8相同的NT内核并拥有多项有别于iOS、Android的优点，使得它发展迅速。目前已拥有超过17万个应用，并且数量还在不断增加中。现在看来越来越多的开发者包括游戏开发者正向WP8平台迁移，想在这个平台上一显身手。
                                </p>
                                <p>
                                    所以采用cocos2d-x引擎开发WP8手机游戏是一件顺理成章的事。鉴于这种趋势，笔者提供这个示例。希望通过本示例，能让各位学习到如何在WP8平台上搭建cocos2d-x的游戏开发环境，并预先告知搭建平台可能会遇到的一些问题及其解决办法。握起你手中的windows phone，我们开始吧！
                                </p>
                                <p>
                                    使自己能够开发Windows
phone 
                                </p>
                                <p>
                                    注册成为windows
phone的开发者
                                </p>
                                <p>
                                    访问以下MSDN的windows phone 开发用户注册页
                                </p>
                                <p>
                                    <span lang="EN-US"><a
                                        href="http://msdn.microsoft.com/en-us/library/windowsphone/help/jj206719(v=vs.105)">http://msdn.microsoft.com/en-us/library/windowsphone/help/jj206719(v=vs.105)</a></span>
                                </p>
                                <p>
                                    <span lang="EN-US"><a
                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/help/jj206719(v=vs.105)">http://msdn.microsoft.com/zh-cn/library/windowsphone/help/jj206719(v=vs.105)</a></span>
                                </p>
                                <p class="imgp">
                                    <img border="0" width="578" height="310"
                                        id="Picture 1" src="images/design_062/image001.jpg">
                                </p>
                                <p>
                                    按步骤填写windows账号和注册Windows phone开发者账号
                                </p>
                                <p>
                                    Windows 账号说明：就是Hotmail、SkyDrive、Xbox LIVE的用户
                                </p>
                                <p>
                                    开发者账号的费用：$19一年；学生账号免费但不能发布收费应用
                                </p>
                                <p>安装编译环境</p>
                                <p>
                                    安装visual
studio 2003
                                </p>
                                <p>
                                    安装windows
phone SDK 8.0
                                </p>
                                <p>
                                    <span lang="EN-US"><a
                                        href="http://dev.windowsphone.com/en-US/downloadsdk">http://dev.windowsphone.com/en-US/downloadsdk</a></span>
                                </p>
                                <p>
                                    <span lang="EN-US"><a
                                        href="http://dev.windowsphone.com/zh-cn/downloadsdk">http://dev.windowsphone.com/zh-cn/downloadsdk</a></span>
                                </p>
                                <p>
                                    cocos2d-x项目的创建
                                </p>
                                <p>
                                    获取最新的cocos2d-x的代码（本文以2.2版本为例）
                                </p>
                                <p>
                                    从官网下载最新代码：<span
                                        lang="EN-US"><a href="http://www.cocos2d-x.org/download">http://www.cocos2d-x.org/download</a></span>
                                </p>
                                <p class="imgp">
                                    <img width="188" height="519"
                                        src="images/design_062/image002.jpg">
                                </p>
                                把下载的zip包解压后就是cocos2d-x的整个工程：
                                <p>整个工程的各个目录大致包含如下内容：</p>
                                <table>
                                    <tr>
                                        <td>
                                            <p>
                                                cocos2dx
                                            </p>
                                        </td>
                                        <td>
                                            <p>
                                                核心代码
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>
                                                cocosDenshion
                                            </p>
                                        </td>
                                        <td>
                                            <p>
                                                封装了声音引擎的代码（SimpleAudioEngine、OpenAL）
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>
                                                extensions
                                            </p>
                                        </td>
                                        <td>
                                            <p>
                                                扩展库代码
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>
                                                external
                                            </p>
                                        </td>
                                        <td>
                                            <p>
                                                包含了很多外部库代码（Box2D、chipmunk等）
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>
                                                sample
                                            </p>
                                        </td>
                                        <td>
                                            <p>
                                                4个示例代码：<span
                                                    lang="EN-US"><br>
                                                    1</span>个小游戏<br>
                                                研究TestCpp代码是个学习cocos2d-x很好的方法
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>
                                                template
                                            </p>
                                        </td>
                                        <td>
                                            <p>
                                                跨平台模板代码
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>
                                                tools
                                            </p>
                                        </td>
                                        <td>
                                            <p>
                                                各种工具脚本
                                            </p>
                                        </td>
                                    </tr>
                                </table>
                                <p>
                                    创建自己的cocos2d-x的HelloWorld：
                                </p>
                                <p>
                                    下载并安装Python，注意不要安装3.0版本以上的【Tip1】
                                </p>
                                <p class="imgp">
                                    <img width="398" height="36"
                                        src="images/design_062/image003.jpg"><br />
                                </p>
                                <p><a href="http://www.python.org/download/">http://www.python.org/download/</a></p>
                                <p>
                                    设置电脑的环境变量，加入Python的安装路径：
                                </p>
                                <p>
                                    <table>
                                        <tr>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td>
                                                <img width="368" height="405"
                                                    src="images/design_062/image004.jpg"></td>
                                        </tr>
                                    </table>
                                    <br clear="ALL">
                                    我的电脑→右键→属性→高级→环境变量→系统变量→path→加入你的python安装目录
                                </p>
                                <p class="imgp">
                                    <img width="557" height="41"
                                        src="images/design_062/image005.jpg">
                                </p>
                                <p>进入cmd，在任意目录下，输入python，不会提示“不是外部或内部命令”就OK。</p>
                                <p>
                                    创建HelloWorld工程：
                                </p>
                                <pre><code>Python create_project.py project
#PROJECT_NAME –package #PACKAGE_NAME –language #PROGRAMING_LANGUAGE</code></pre>
                                <p>
                                    进入cocos2d-x-2.2.0\tools\project-creator目录，在cmd下执行：
                                </p>
                                <p>Note：上面的脚本中有三个变量需要根据自己的情况替换</p>
                                <p>
                                    #PROJECT_NAME ：工程的名称
                                </p>
                                <pre><code>#PACKAGE_NAME：包名称（格式：com.mycompany.mygame）
#PROGRAMING_LANGUAGE：编程语言（cpp, lua, javascript）</code></pre>
                                <p>如果看到如下界面，表示工程创建成功，恭喜！</p>
                                <p class="imgp">
                                    <img border="0" width="342" height="144"
                                        id="Picture 12" src="images/design_062/image006.png">
                                </p>
                                <p>
                                    把HelloWorld从cocos2d-x的大工程中独立出来：
                                </p>
                                <p>
                                    刚才的HelloWorld在cocos2d-x-2.2.0\projects\目录下，可以根据自己的情况新建一个目录，把HelloWorld代码和cocos2d-x必要的文件拷贝过去，做一个干净的工程，注意目录结构不能破坏。做好的工程大致如下所示：
                                </p>
                                <p class="imgp">
                                    <img border="0" width="152" height="112"
                                        id="Picture 14" src="images/design_062/image007.jpg">
                                </p>
                                <p>进一步简化工程创建的步骤</p>
                                <p>
                                    笔者建议开发者可以自己写一个bat文件，把创建和工程独立合二为一，做到一步完成。这里给出一个bat的例子供大家参考【TIP2】：
                                </p>
                                <pre><code>@echo off
set /p directoryName=Please Input Directory Name:
if "%directoryName%"=="" goto inputError
set /p projectName=Please Input Project Name:
if "%projectName%"=="" goto inputError
set /p packageName=Please Input Package Name:
if "%packageName%"=="" goto inputError
create_project.py -project %projectName% -package %packageName% -language cpp
xcopy ..\..\projects\%projectName% d:\%directoryName%\projects\%projectName% /s/e/i/y
xcopy ..\..\cocos2dx d:\%directoryName%\cocos2dx /s/e/i/y
xcopy ..\..\cocosDenshion d:\%directoryName%\cocosDenshion /s/e/i/y
xcopy ..\..\extensions d:\%directoryName%\extensions /s/e/i/y
xcopy ..\..\external d:\%directoryName%\external /s/e/i/y
@echo Create Project OK!
pause
goto finish
:inputError
@echo Need Directory & Project & Package Name!
pause
:finish</code></pre>
                                <p>
                                    按上述方法，创建工程(MyDemo)，观察一下工程的目录结构
                                </p>
                                <p>硬盘上的目录结构见下左图</p>
                                <p>
                                    点击proj.wp8目录下的.sln文件，打开WP8的工程
                                </p>
                                <p>目录结构见下右图</p>
                                <p class="imgp">
                                    <img border="0" width="164" height="236"
                                        id="Picture 16" src="images/design_062/image008.jpg">&nbsp;
                                </p>
                                <p class="imgp">
                                    <img border="0" width="215" height="292"
                                        id="Picture 17" src="images/design_062/image009.jpg">
                                </p>
                                <p>&nbsp;通过观察，我们可以得出几点结论：</p>
                                <p>
                                    以Proj.开头的目录存放的是和各个平台相关的代码和工程文件还有资源(比如Splash)
                                </p>
                                <p>
                                    Class目录存放的是和平台无关的代码即用cocos2d-x写的游戏代码部分(AppDelegate, HelloWorldScene.cpp)。大家开发游戏的时候也应该把代码放在此目录下。
                                </p>
                                <pre><code>IFrameworkView^ Direct3DApplicationSource::CreateView()
{
	return ref new MyDemo();
}
[Platform::MTAThread]
int main(Platform::Array<Platform::String^>^)
{
	auto direct3DApplicationSource = ref new Direct3DApplicationSource();
	CoreApplication::Run(direct3DApplicationSource);
	return 0;
}
ref class MyDemo sealed : public Windows::ApplicationModel::Core::IFrameworkView
{
public:
	MyDemo();
       ….
private:
	// The AppDelegate for the Cocos2D app
	AppDelegate app;
};</code></pre>
                                <p>
                                    通过如下代码可以了解引擎是如何把AppDelegate加到WP项目中去的
                                </p>
                                <p>跨平台特性的体现：</p>
                                <p>
                                    AppDelegate.cpp, HelloWorldScene.cpp等代码在任何平台的工程里都是一样的
                                </p>
                                <p>
                                    Resources目录存放的是游戏资源，各个平台都是统一的一份
                                </p>
                                <p>
                                    扩充HelloWorld工程
                                </p>
                                <p>
                                    查看工程目录可以看到，引擎只给我们导入了基本的库(libcocos2d)，而比如声音库CocosDenshion，物理库Box2D等并没有导入，所以我们需要手动将这些库导入。笔者以导入CocosDenshion为例，介绍如何加入这些库。具体步骤如下：
                                </p>
                                <p>
                                    添加库项目到工程里：选中解决方案 右键，选择 “现有项目”
                                </p>
                                <p class="imgp">
                                    <img border="0" width="535" height="423"
                                        id="Img1" src="images/design_062/image010.jpg">
                                </p>
                                <p>
                                    选择
                                    cocos2d-x-2.2\CocosDenshion\proj.wp8目录下的 .vcxproj文件，加入工程
                                </p>
                                <p class="imgp">
                                    <img border="0" width="234" height="105"
                                        id="Picture 7" src="images/design_062/image011.jpg">
                                </p>
                                <p>增加项目依赖：选中解决方案右键，选择“项目依赖项”</p>
                                <p class="imgp">
                                    <img border="0" width="408" height="418"
                                        id="Picture 10" src="images/design_062/image012.jpg">
                                </p>
                                <p>
                                    勾选我们刚才添加的库，记得esUtil_phone也勾选
                                </p>
                                <p class="imgp">
                                    <img border="0" width="413" height="382"
                                        id="Picture 13" src="images/design_062/image013.jpg">
                                </p>
                                <p>
                                    添加引用：选中项目名(MyDemo)右键，选择“属性”，在“框架和引用”里面
                                    点击 “添加新引用”，勾选新添加的库
                                </p>
                                <p class="imgp">
                                    <img border="0" width="544" height="386"
                                        id="Picture 18" src="images/design_062/image014.jpg">
                                </p>
                                <p class="imgp">
                                    <img border="0" width="544" height="374"
                                        id="Picture 19" src="images/design_062/image015.jpg">
                                </p>
                                <p>
                                    为了更方便使用添加的库，最好增加新库的包含路径【Tip3】：
                                </p>
                                <p>
                                    选中项目名(MyDemo)右键，选择“属性”，在“C/C++通用”里面，选择“附加包含目录”，增添新路径( $(ProjectDir)..\..\..\CocosDenshion\include
)
                                </p>
                                <p class="imgp">
                                    <img border="0" width="542" height="384"
                                        id="Picture 20" src="images/design_062/image016.jpg">
                                </p>
                                <p class="imgp">
                                    <img border="0" width="452" height="372"
                                        id="Picture 6" src="images/design_062/image017.jpg">
                                </p>
                                <p>
                                    至此HelloWorld工程正式建立起来了。
                                </p>
                                <p>
                                    按下图所示设置VS的调试选项，编译并运行。
                                </p>
                                <p class="imgp">
                                    <img border="0" width="497" height="28"
                                        id="Picture 31" src="images/design_062/image018.jpg">
                                </p>
                                <p>哇，出现了模拟器画面，恭喜啊，成功了！</p>
                                <p class="imgp">
                                    <img border="0" width="476" height="261"
                                        id="Picture 192" src="images/design_062/image019.jpg">
                                </p>
                                <p>ASSETS详解</p>
                                <p>
                                    认识XAP文件和Assets
                                </p>
                                <p>看一下上述工程编译成功后的输出（中间省略了一些输出）</p>
                                <p class="imgp">
                                    <img border="0" width="535" height="91"
                                        id="Picture 28" src="images/design_062/image020.jpg">
                                </p>
                                <p>
                                    XAP文件就是windows phone的包文件格式，相当于Android的APK和iOS的APP。它是一个标准的<span lang="EN-US">zip<a
                                        href="http://baike.baidu.com/view/1125150.htm" target="_blank">压缩文件</a></span>，包括了WP应用程序所需的一切文件，如<span lang="EN-US"><a
                                            href="http://baike.baidu.com/view/94241.htm" target="_blank">程序集</a></span>、<span lang="EN-US"><a
                                                href="http://baike.baidu.com/view/675612.htm" target="_blank">资源文件</a></span>等。通过项目的“输出路径”，我们可以找到生成的XAP的文件。
                                </p>
                                <p class="imgp">
                                    <img border="0" width="536" height="86"
                                        id="Picture 22" src="images/design_062/image021.jpg">
                                </p>
                                <p class="imgp">
                                    <img border="0" width="536" height="169"
                                        id="Picture 23" src="images/design_062/image022.jpg">
                                </p>
                                <p>
                                    我们试着把XAP文件的后缀改为zip，然后解压，看一下里面包含的内容：
                                </p>
                                <p class="imgp">
                                    <img border="0" width="182" height="183"
                                        id="Picture 24" src="images/design_062/image023.jpg"><span
                                            lang="EN-US">&nbsp;<img border="0" width="163" height="94" id="Picture 199"
                                                src="images/design_062/image024.jpg">&nbsp;<img border="0"
                                                    width="131" height="90" id="Picture 198"
                                                    src="images/design_062/image025.jpg"></span>
                                </p>
                                <p>
                                    左图是XAP文件包含的内容，看上去和Android有点类似，包括程序文件(exe)、应用配置文件WMAppManifest.xml（类似于安卓的AndroidManifest.xml）、一些dll和一个Assets目录。中图是Assets目录、右图是Assets/Resources目录包含的内容，可以看到主要是游戏资源。
                                </p>
                                <p>
                                    由此可见，和Android一样，WP的程序会把需要用到的资源放在Assets目录下。
                                </p>
                                <p>
                                    进一步认识Assets目录（本节内容可以跳过）
                                </p>
                                <p>
                                    利用cocos2d-x的跨平台特性，我们可以做一个实验
                                </p>
                                <p>
                                    分别编译并运行MyDemo的proj.win32和proj.wp8工程，成功后分别出现如下画面
                                </p>
                                <p class="imgp">
                                    <img border="0" width="190" height="138"
                                        id="Picture 29" src="images/design_062/image026.jpg"><span
                                            lang="EN-US">&nbsp;<img border="0" width="251" height="138" id="Picture 30"
                                                src="images/design_062/image027.jpg"></span>
                                </p>
                                <p>
                                    在整个工程的Resource目录下，找到HelloWorld.png图片，把这张图片的文件名改为
                                </p>
                                <p>“Helloworld1.png”</p>
                                <p class="imgp">
                                    <img border="0" width="383" height="154"
                                        id="Picture 193" src="images/design_062/image028.jpg">
                                </p>
                                <p>
                                    打开HelloWorldScene.cpp，找到bool
HelloWorld::init()函数做如下修改
                                </p>
                                <pre><code>//   CCSprite* pSprite = CCSprite::create("HelloWorld.png");
	CCSprite* pSprite = CCSprite::create("HelloWorld1.png");</code></pre>
                                <p>（此文件在两个工程内都被调用，只要在任一个工程修改，另一个工程内会自动更新）</p>
                                <p>分别编译并运行，出现如下画面</p>
                                <p class="imgp">
                                    <img border="0" width="190" height="138"
                                        id="Picture 195" src="images/design_062/image026.jpg"><span
                                            lang="EN-US">&nbsp;<img border="0" width="266" height="137" id="Picture 196"
                                                src="images/design_062/image029.jpg"></span>
                                </p>
                                <p>
                                    很明显，Win32成功了，WP8失败了。Debug一下就会知道pSprite的指针是空的。也就是没有拿到刚才已经改名的HelloWorld1.png这张图。为什么会这样呢？我们打开新生成的XAP文件看一下。结果发现XAP包里的Assets/Resources目录下还是原来那张HelloWorld.png的贴图，根本没有HelloWorld1.png的贴图。所以仅仅修改代码和工程的Resources目录下的资源，是无法影响XAP包里的资源的，正确方法请看第3点。
                                </p>
                                <p>
                                    （win32工程不会错误的原因请读者自己研究）
                                </p>
                                <p>
                                    学习如何把资源加入到Assets目录中
                                </p>
                                <p>
                                    我们打开MyDemo的WP8工程，在VS的Solution Explorer下可以发现有Assets目录，见下图，这个目录下存放的就是打入XAP包里Assets目录下的所有资源
                                </p>
                                <p class="imgp">
                                    <img border="0" width="249" height="271"
                                        id="Picture 21" src="images/design_062/image030.jpg">
                                </p>
                                <p>
                                    选择Assets下任意一张png图片，我们查看一下它所在的硬盘位置
                                </p>
                                <p class="imgp">
                                    <img border="0" width="545" height="137"
                                        id="Picture 27" src="images/design_062/image031.jpg">
                                </p>
                                <p>
                                    怎么样，吃惊了吧。这个资源并不在我们之前一直提到的工程的Resources目录里。看不清的读者，可以看下图。
                                </p>
                                <p>
                                    工程的Resources目录：(HelloWorld1.png是经过第2点实验后改过名的图片)
                                </p>
                                <p class="imgp">
                                    <img border="0" width="483" height="171"
                                        id="Picture 197" src="images/design_062/image032.jpg">
                                </p>
                                <p>
                                    WP8工程里的Assets/Resources目录：
                                </p>
                                <p>
                                    (原来的HelloWorld.png和改过名的HelloWorld1.png都在)
                                </p>
                                <p class="imgp">
                                    <img border="0" width="532" height="178"
                                        id="Picture 200" src="images/design_062/image033.jpg">&nbsp;
                                </p>
                                <p>
                                    把”MyDemo/Resources”
                                    目录定义为A目录，
                                </p>
                                <p>
                                    把”MyDemo/proj.wp8/Assets/Resources”目录定义为B目录。
                                </p>
                                <p>我们得出如下结论：</p>
                                <p>
                                    VS里面引用的都是B目录下的资源，即真正打入到XAP包的是B目录下的资源；
                                </p>
                                <p>
                                    VS编译时会把A目录下的资源拷贝到B目录下；只会增加、覆盖，不会删除；
                                </p>
                                <p>为了证实有拷贝这个过程，再次仔细查看编译后的输出，发现有如下提示</p>
                                <p class="imgp">
                                    <img border="0" width="350" height="65"
                                        id="Picture 26" src="images/design_062/image034.jpg">
                                </p>
                                <p>
                                    （读者也可以在A目录下增加一个文件，然后编译工程，去查看B目录）
                                </p>
                                <p>阶段小结</p>
                                <p>
                                    根据以上结论，我们可以用如下顺序来处理资源【Tip4】：
                                </p>
                                <p>
                                    清空B目录
                                </p>
                                <p>
                                    在A目录下增加、删除、修改资源
                                </p>
                                <p>
                                    打开并编译工程，确保A拷贝到B
                                </p>
                                <p>
                                    在打开工程的Assets下引用B目录的资源，并做修改
                                </p>
                                <p>
                                    （如果引用A目录下的资源情况会是怎样呢？读者可以自己去测试一下）
                                </p>
                                <p>再次编译并生成XAP</p>
                                <p>
                                    我们用上述方法，请读者试着增加HelloWorld1.png、删除HelloWorld.png，并创建加入一个文本文件1.txt。成功后VS工程的Assets内容和XAP/Assets/Resources内容应如下所示：
                                </p>
                                <p class="imgp">
                                    <img border="0" width="208" height="127"
                                        id="Picture 201" src="images/design_062/image035.jpg"><span
                                            lang="EN-US">&nbsp;<img border="0" width="177" height="119" id="Picture 203"
                                                src="images/design_062/image036.jpg">&nbsp;</span>
                                </p>
                                <p>最后一步</p>
                                <p>
                                    我们再创建一个文本文件1.txt，把它改名为1.123，然后按照上面的步骤，最后引入到Assets下。编译后，查看一下XAP文件，看看1.123有没有。
                                </p>
                                <p class="imgp">
                                    <img border="0" width="206" height="149"
                                        id="Picture 204" src="images/design_062/image037.jpg"><span
                                            lang="EN-US">&nbsp;<img border="0" width="177" height="119" id="Picture 205"
                                                src="images/design_062/image038.jpg"></span>
                                </p>
                                <p>
                                    结果如上所示，虽然我们放入了1.123，但是却没有打入XAP/Assets/Resources/。
                                </p>
                                <p>
                                    这是因为引入到Assets目录下的资源，VS只将认识的资源类型，默认打包进XAP。如果不是的话，则不会打进XAP。这个可以设置，设置方法：对资源右击，选择属性
                                </p>
                                <p class="imgp">
                                    <img border="0" width="540" height="349"
                                        id="Picture 206" src="images/design_062/image039.jpg">
                                </p>
                                <p>
                                    “内容”这个属性选择 ：是
                                </p>
                                <p class="imgp">
                                    <img border="0" width="540" height="383"
                                        id="Picture 207" src="images/design_062/image040.jpg">
                                </p>
                                <p>
                                    编译后，查看一下XAP文件，1.123果然有了。
                                </p>
                                <p class="imgp">
                                    <img border="0" width="178" height="138"
                                        id="Picture 208" src="images/design_062/image041.jpg">
                                </p>
                                <p>
                                    恭喜，相信你已经完全了解Assets了！
                                </p>
                                <p>推荐一些常用的游戏资源转换工具</p>
                                <p>
                                    利用TexturePacker软件来组合、整理图片【Tip5】
                                </p>
                                <p>
                                    <span lang="EN-US"><a
                                        href="http://www.codeandweb.com/texturepacker">http://www.codeandweb.com/texturepacker</a></span>
                                </p>
                                <p>利用格式工厂等软件转换声音文件</p>
                                <p><span lang="EN-US"><a href="http://www.pcfreetime.com/">http://www.pcfreetime.com/</a></span></p>
                                <p>
                                    利用plistEditor等软件在win8系统上编辑plist文件
                                </p>
                                <p><span lang="EN-US"><a href="http://www.icopybot.com/">http://www.icopybot.com/</a></span></p>
                                <p>导入游戏</p>
                                <p>
                                    有了以上知识的铺垫，读者应该可以真正用cocos2d-x的语句来编写游戏代码了。关于如何用cocos2d-x开发游戏，请参考官网介绍，此处笔者不做详细展开：
                                </p>
                                <p><span lang="EN-US"><a href="http://www.cocos2d-x.org/">http://www.cocos2d-x.org/</a></span></p>
                                <p>
                                    作为试验，在上述已经搭好的环境下，笔者参考下面的网址，把里面的cocos2d-x的代码直接拿到了MyDemo工程里，非常方便：
                                </p>
                                <p>
                                    <span lang="EN-US"><a
                                        href="http://www.raywenderlich.com/33752/cocos2d-x-tutorial-for-ios-and-android-space-game">http://www.raywenderlich.com/33752/cocos2d-x-tutorial-for-ios-and-android-space-game</a></span>
                                </p>
                                <p>这是完成的游戏界面，很酷吧。</p>
                                <p class="imgp">
                                    <img border="0" width="518" height="281"
                                        id="Picture 25" src="images/design_062/image042.jpg">
                                </p>
                                <p>
                                    在WindowsPhone手机上运行游戏
                                </p>
                                <p>目前为止我们都是在模拟器上运行游戏，如何在真机上运行呢？很简单。</p>
                                <p>
                                    使用Windows
Phone SDK自带的注册工具，注册手机
                                </p>
                                <p class="imgp">
                                    <img border="0" width="436" height="388"
                                        id="Picture 202" src="images/design_062/image043.jpg">
                                </p>
                                <p>
                                    详细步骤请参考MSDN上的介绍：
                                </p>
                                <p>
                                    <span lang="EN-US"><a
                                        href="http://msdn.microsoft.com/library/windowsphone/develop/ff769508(v=vs.105).aspx">http://msdn.microsoft.com/library/windowsphone/develop/ff769508(v=vs.105).aspx</a></span>
                                </p>
                                <p>
                                    把WP手机用USB线连接到电脑，按下图所示设置VS的调试选项进行真机调试
                                </p>
                                <p class="imgp">
                                    <img border="0" width="408" height="27"
                                        id="Picture 210" src="images/design_062/image044.jpg">
                                </p>
                                <p>
                                    使用Windows
Phone SDK自带的部署工具，部署XAP到手机
                                </p>
                                <p class="imgp">
                                    <img border="0" width="419" height="389"
                                        id="Picture 211" src="images/design_062/image045.jpg">
                                </p>
                                <p>
                                    详细步骤请参考MSDN上的介绍：
                                </p>
                                <p>
                                    <span lang="EN-US"><a
                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff928362(v=vs.105).aspx">http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/ff928362(v=vs.105).aspx</a></span>
                                </p>
                                <p>结束语</p>
                                <p>
                                    笔者希望通过这篇文章，能让各位读者以最快的速度熟悉在Windows Phone上使用cocos2d-x。当然由于篇幅和时间有限，这篇文章还有很多不足之处。欢迎各位技术大牛指摘。当然更希望这篇文章能起到一个抛砖引玉的作用，希望大家都来开发Windows Phone游戏，成为游戏发展的弄潮儿，谢谢！
                                </p>
                                <p style="text-align: right">
                                    微软中国有限公司 开发工具及平台事业部<br />
                                    开发技术顾问<br />
                                    梅颖广<br />
                                    yimei@microsoft.com<br />
                                </p>
                            </div>
                        </div>
                        <div class="textlist">
                            另两篇文章：<br />
                            <ul>
                                <li><a href="design_06.html">多平台游戏渲染开发</a>
                                <li><a href="design_062.html">游戏开发框架</a>
                            </ul>
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>
            </div>
        </div>
        <!--End Content-->
        <div style="text-align: right" class="gotoTop"><a href="javascript:scroll(0,0)"></a></div>
        <!--Begin ProudctLinks-->
        <div class="ms-pro-links">
            <div class="grid-container clearfix">
                <div class="cam-links">
                    其它微软站点
                    <a href="http://www.microsoft.com/zh-cn/default.aspx">微软中国官方网站</a>
                    <a href="http://www.microsoft.com/zh-cn/download/default.aspx?WT.mc_id=MSCOM_zh-cn_HP_Footer_downloads" target="_blank">微软中国下载中心</a>
                    <a href="http://www.microsoftstore.com.cn?WT.mc_id=MSCOM_003" target="_blank">微软中国官方商城</a>
                    <a href="http://www.microsoft.com/china/newsletter/" target="_blank">订阅电子期刊</a>
                    <a href="https://sales.liveperson.net/hc/21661174/?cmd=file&file=visitorWantsToChat&site=21661174&byhref=1&SESSIONVAR!skill=APGC.PRC.ZH.CS.CON.PRESLS.GENERAL" target="_blank">联系微软销售代表</a>
                    <a href="http://www.microsoft.com/zh-cn/sitemap.aspx" target="_blank">网站地图</a>
                </div>
            </div>
        </div>
        <!--End ProudctLinks-->
        <!--Begin footer-->
        <div class="footer">
            <div class="grid-container">
                <img src="http://i.s-microsoft.com/global/ImageStore/PublishingImages/logos/hp/logo-type-1x.png" alt="microsoft" class="logo">
                <ul>
                    <li><a href="http://www.miibeian.gov.cn/" title="">京ICP备09042378号-6</a></li>
                    <li><a href="https://profile.microsoft.com/RegSysProfileCenter/default.aspx?lcid=2052" title="">个人信息中心</a></li>
                    <li><a href="http://support.microsoft.com/contactus/?ws=support" title="">与我们联系</a></li>
                    <li><a href="http://go.microsoft.com/fwlink/?LinkId=248681" title="">隐私权声明</a></li>
                    <li><a href="http://go.microsoft.com/?linkid=4412892" title="">使用条款</a></li>
                    <li><a href="http://www.microsoft.com/About/Legal/EN/US/IntellectualProperty/Trademarks/EN-US.aspx" title="">商标</a></li>
                    <li>&copy; 2013 Microsoft</li>
                </ul>
            </div>
        </div>
        <!--End footer-->
        <!-- Begin MDA WEDCS -->
        <script type="text/JavaScript">
            var varSegmentation = 0;
            var varClickTracking = 1;
            var varCustomerTracking = 1;
            var varAutoFirePV = 1;
            var Route = "#";
            var Ctrl = "#"
            //document.write("<script type='text/javascript' src='" + window.location.protocol + "//c.microsoft.com/ms.js'><"+"/script>");
        </script>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script type="text/javascript" src="./assets/js/script.js"></script>
        <script type="text/javascript" src="./js/siteSearch.js"></script>
        <noscript>
            <img alt="" width="1" height="1" src="http://c.microsoft.com/trans_pixel.aspx/" />
        </noscript>
        <!-- Begin MDA WEDCS -->
    </div>
</body>
</html>

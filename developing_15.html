<!doctype html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>获取后台服务器数据</title>
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="stylesheet" href="css/templete.css" type="text/css" media="all" />
    <meta charset="UTF-8">
</head>
<body class="level-2">
    <div class="wrapper">
        <!--Begin header-->
        <div class="header">
            <div class="grid-container clearfix">
                <div class="header-left">
                    <img alt="Microsoft" src="http://i.s-microsoft.com/global/ImageStore/PublishingImages/logos/hp/logo-lg-1x.png" width="94" height="20">
                    <h1>X-Platform</h1>
                </div>
                <div id="mscom-search" class="mscom-search" style="margin-top: 37px;">
                    <div class="search-form">
                        <form action="" id="search-form">
                            <div class="input-wrapper">
                                <label class="screen-reader-text" for="search-input">搜索 Microsoft.com</label>
                                <input id="search-input" type="text" class="input-area" autocomplete="off">
                            </div>
                            <button class="search-submit" id="search-btn" type="submit">
                                <img width="16" height="16" alt="Submit" src="http://i.s-microsoft.com/global/imagestore/PublishingImages/sprites/search-button-blue.png"></button>
                        </form>
                    </div>
                    <div class="search-results-box" id="results">
                        <div class="search-scope">
                            <ul>
                                <li class=""><a class="checked" search="microsoft" role="search">搜索 Microsoft.com</a></li>
                                <li class=""><a search="internet" role="search">搜索互联网</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--End header-->
        <br />
        <!--Begin Content-->
        <div class="content">
            <div class="wrapper">
                <div class="wrapper-header">
                    <div>
                        <a href="index.html">
                            <img src="./assets/image/banner_1.jpg"></a>
                    </div>
                </div>
                <div class="main">
                    <div class="nav">
                        <div class="block article-nav-block">
                            <h2>移动应用开发生命周期</h2>
                            <div class="menu">
                                <h3><a href="idea.html">计划<span>Idea/Planning</span></a></h3>
                                <ul>
                                    <li><a href="idea_01.html">平台总览</a></li>
                                    <li><a href="idea_02.html">开发工具、开发环境和模拟器</a></li>
                                    <li><a href="idea_03.html">应用结构和生命周期</a></li>
                                </ul>
                            </div>
                            <div class="menu">
                                <h3><a href="design.html">设计<span>Design</span></a></h3>
                                <ul>
                                    <li><a href="design_01.html">UI Layout的设计</a></li>
                                    <li><a href="design_02.html">UI的控件</a></li>
                                    <li><a href="design_03.html">UI页面的控制和导航</a></li>
                                    <li><a href="design_04.html">不同屏幕尺寸和分辨率的适配</a></li>
                                    <li><a href="design_05.html">第三方SDK</a></li>
                                    <li><a href="design_06.html">游戏开发</a></li>
                                </ul>
                            </div>
                            <div class="menu active">
                                <h3><a href="developing.html">开发<span>Developing</span></a></h3>
                                <ul>
                                    <li><a href="developing_01.html">开发语言</a></li>
                                    <li><a href="developing_02.html">Audio、Video Player应用的开发</a></li>
                                    <li><a href="developing_03.html">General APIs Mapping</a></li>
                                    <li><a href="developing_04.html">IAP应用内支付</a></li>
                                    <li><a href="developing_05.html">LBS应用</a></li>
                                    <li><a href="developing_06.html">LBS、镜头和传感器应用接口使用</a></li>
                                    <li><a href="developing_07.html">Native Code（C和C++）支持</a></li>
                                    <li><a href="developing_08.html">Push Notification</a></li>
                                    <li><a href="developing_09.html">Sharing in Social Network</a></li>
                                    <li><a href="developing_10.html">Source Code Control</a></li>
                                    <li><a href="developing_11.html">UI上的Data Binding</a></li>
                                    <li><a href="developing_12.html">Windows 8.1和WP 8 Sharing应用分享功能实现</a></li>
                                    <li><a href="developing_13.html">多媒体</a></li>
                                    <li><a href="developing_14.html">后台任务和多任务处理</a></li>
                                    <li><a href="developing_15.html">获取后台服务器数据</a></li>
                                    <li><a href="developing_16.html">浏览器控件WebView</a></li>
                                    <li><a href="developing_17.html">数据库（SQLite）</a></li>
                                    <li><a href="developing_18.html">数据网络和数据通讯</a></li>
                                    <li><a href="developing_19.html">通话和短信功能</a></li>
                                    <li><a href="developing_20.html">图形处理(Drawing & Animation)</a></li>
                                    <li><a href="developing_21.html">文件系统和应用设置</a></li>
                                    <li><a href="developing_22.html">应用间通信</a></li>
                                    <li><a href="developing_23.html">支付方式</a></li>
                                    <li><a href="developing_24.html">Windows 8.1应用外设开发</a></li>
                                </ul>
                            </div>
                            <div class="menu">
                                <h3><a href="testing.html">测试<span>Testing</span></a></h3>
                                <ul>
                                    <li><a href="testing_01.html">Windows 8 and WP 8开发FAQ</a></li>
                                </ul>
                            </div>
                            <div class="menu last">
                                <h3><a href="distribute.html">发布<span>Distribute</span></a></h3>
                                <ul>
                                    <li><a href="distribute_01.html">应用商店(发布和更新应用)</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="block success-story-nav-block">
                            <h2>成功案例</h2>
                        </div>
                        <div class="block others">
                            <a href="sample_code.html" class="left">示例代码</a>
                            <a href="http://msdn.microsoft.com/zh-cn/dn473954" class="right">教学视频</a>
                        </div>
                    </div>
                    <div class="content">
                        <h3 class="title">获取后台服务器数据<span><a href="index.html">返回首页&gt;</a></span></h3>
                        <div class="article-content">
                            <div class="WordSection1">
                                <p class="MsoToc1"><a href="#_Toc371584151">概述</a></p>
                                <p class="MsoToc1"><a href="#_Toc371584152">Windows Phone 8 Web服务</a></p>
                                <p class="MsoToc2"><a href="#_Toc371584153">WebClient类</a></p>
                                <p class="MsoToc3"><a href="#_Toc371584154">使用WebClient类</a></p>
                                <p class="MsoToc2"><a href="#_Toc371584155">HttpWebRequest类</a></p>
                                <p class="MsoToc3"><a href="#_Toc371584156">使用HttpWebRequest类发送GET和POST请求</a></p>
                                <p class="MsoToc1"><a href="#_Toc371584157">Window8 Web服务</a></p>
                                <p class="MsoToc2"><a href="#_Toc371584158">HttpClient</a></p>
                                <p class="MsoToc3"><a href="#_Toc371584159">使用HttpClient类发送GET请求</a></p>
                                <p class="MsoToc3">
                                    <a href="#_Toc371584160">使用HttpClient类和HttpRequestMessage
类发送POST请求</a>
                                </p>
                                <p class="MsoToc3"><a href="#_Toc371584161">获得请求返回数据</a></p>
                                <p class="MsoToc1"><a href="#_Toc371584162">AndroidWeb服务</a></p>
                                <p class="MsoToc2"><a href="#_Toc371584163">发送GET请求</a></p>
                                <p class="MsoToc2"><a href="#_Toc371584164">发送POST请求</a></p>
                                <p class="MsoToc1"><a href="#_Toc371584165">IOS web服务</a></p>
                                <p class="MsoToc2"><a href="#_Toc371584166">发送Get请求：</a></p>
                                <p class="MsoToc2"><a href="#_Toc371584167">发送Post请求：</a></p>
                                <p class="MsoToc1"><a href="#_Toc371584168">序列化和反序列化</a></p>
                                <p class="MsoToc2"><a href="#_Toc371584169">XML</a></p>
                                <p class="MsoToc3"><a href="#_Toc371584170">Windows phone和Windows</a></p>
                                <p class="MsoToc3"><a href="#_Toc371584171">Android</a></p>
                                <p class="MsoToc3"><a href="#_Toc371584172">Ios</a></p>
                                <p class="MsoToc2"><a href="#_Toc371584173">Json</a></p>
                                <p class="MsoToc3"><a href="#_Toc371584174">Windows phone和Windows</a></p>
                                <p class="MsoToc3"><a href="#_Toc371584175">Android</a></p>
                                <p class="MsoToc3"><a href="#_Toc371584176">IOS</a></p>
                                <br />
                                <h1><a name="_Toc371584151">概述</a></h1>
                                <p>Windows8和Windows Phone8提供了用于通过HTTP协议发送和接受网络数据的类。在Windows8中为HttpClient类，Windows Phone中为WebClient和HttpWebRequest类。</p>
                                <p>Android系统包含两种HTTP Client：HttpURLConnection和Apache HTTP Client。蓝牙技术支持HTTPS协议，流方式上传和下载，请求超时配置，IPv6和连接池。</p>
                                <p>IOS SDK的NSURLRequest及其子类提供通过http协议发送和接受网络数据的功能。</p>
                                <h1><a name="_Toc371584152">Windows Phone 8 Web服务</a></h1>
                                <p>
                                    Web 服务允许以编程方式访问 Internet 上的各种数据。数据服务是基于 HTTP 的 Web 服务，这种
Web 服务实现开放数据协议 (OData) 以将数据公开为资源，这些资源通过数据模型进行定义并通过统一资源标识符 (URI) 进行寻址。
                                </p>
                                <p>
                                    Web 和数据服务都使用一种基于 XML 的开放式语言来描述其基于 Web 的 API。使用 Web 服务描述语言 (WSDL) 描述 Web 服务提供的服务。概念性架构定义语言 (CSDL) 描述数据服务提供的数据模型。有关更多信息，请参见&nbsp;<a href="http://go.microsoft.com/fwlink/?LinkId=207893">Web
服务描述语言 (WSDL)</a>&nbsp;和<a
    href="http://go.microsoft.com/fwlink/?LinkId=207894">概念性架构定义文件格式</a>。
                                </p>
                                <p>Web 服务</p>
                                <p>
                                    因为在 Internet 上发布的绝大多数 Web 服务都基于 HTTP，因此您可以使用&nbsp;<a
                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.net.httpwebrequest(v=vs.105).aspx">HttpWebRequest</a>&nbsp;和&nbsp;<a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.net.webclient(v=vs.105).aspx">WebClient</a>类从 Windows&nbsp;Phone 应用访问 Web 服务。为了帮助减轻生成 Web 服务通常所需的其他代码的任务，可以使用服务模型代理生成工具 (SLsvcUtil.exe) 或 Visual Studio 的“添加服务引用”功能生成代理类。有关如何使用<a
                                                href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.net.webclient(v=vs.105).aspx">WebClient</a>&nbsp;类访问 RSS 源的示例，请参见&nbsp;<a
                                                    href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/hh487167(v=vs.105).aspx">如何为 Windows Phone 创建基本的 RSS 读取器</a>。
                                </p>
                                <p>根据 Web 服务 WSDL 文件，Web 服务代理类为 Web 服务实现序列化、请求和响应代码。您可以在 Windows&nbsp;Phone 应用中使用生成的代理类与相应的 Web 服务进行通信。</p>
                                <p>数据服务 (OData)</p>
                                <p>
                                    数据服务是基于 HTTP 的
Web 服务，该 Web 服务实现开放数据协议 (OData)
以将数据公开为资源，这些资源通过数据模型进行定义并通过 URI 进行寻址。这使您能够使用具象状态传输 (REST) 的语义（尤其是 GET、PUT、POST 和 DELETE 等标准
HTTP 谓词）访问和更改数据。
                                </p>
                                <p>
                                    由于数据服务是基于 HTTP 的，因此您可以使用&nbsp;<a
                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.net.httpwebrequest(v=vs.105).aspx">HttpWebRequest</a>&nbsp;和&nbsp;<a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.net.webclient(v=vs.105).aspx">WebClient</a>&nbsp;类从 Windows&nbsp;Phone 应用访问数据服务。为了帮助减轻生成数据服务所需其他代码的任务，您可以使用 WCF 数据服务客户端实用工具 DataSvcUtil.exe 或 Visual Studio 的“添加服务引用”功能生成一个基于数据服务 CSDL 文件的代理类。您可以在 Windows&nbsp;Phone 应用中使用生成的代理类与相应的数据服务进行通信。
                                </p>
                                <p>在WindowsPhone应用中可以使用 HttpWebRequest 和 WebClient 类访问 Web 服务。</p>
                                <h2><a name="_Toc371584153">WebClient类</a></h2>
                                <p>
                                    提供用于将数据发送到由 URI 标识的资源及从这样的资源接收数据的常用方法。WebClient&nbsp;类提供向 URI 标识的任何本地、Intranet 或 Internet 资源发送数据以及从这些资源接收数据的。WebClient&nbsp;类使用&nbsp;<a
                                        href="http://msdn.microsoft.com/zh-cn/library/system.net.webrequest.aspx">WebRequest</a>&nbsp;类提供对资源的访问。&nbsp;WebClient&nbsp;实例可以通过任何已向&nbsp;<a
                                            href="http://msdn.microsoft.com/zh-cn/library/system.net.webrequest.registerprefix.aspx">WebRequest.RegisterPrefix</a>&nbsp;方法注册的&nbsp;<a
                                                href="http://msdn.microsoft.com/zh-cn/library/system.net.webrequest.aspx">WebRequest</a>&nbsp;子代访问数据。
                                </p>
                                <p class="MsoListParagraph" style='margin-left: 21.0pt;'>
                                    l&nbsp;
                            <b>属性</b>
                                </p>
                                <table>
                                    <tr>
                                        <td>
                                            <p>AllowReadStreamBuffering</p>
                                        </td>
                                        <td>
                                            <p>获取或设置一个值，该值指示是否对从某一 WebClient 实例的 Internet 资源读取的数据进行缓冲处理</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>AllowWriteStreamBuffering</p>
                                        </td>
                                        <td>
                                            <p>获取或设置一个值，该值指示是否对写入到 WebClient 实例的 Internet 资源的数据进行缓冲处理</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>BaseAddress</p>
                                        </td>
                                        <td>
                                            <p>获取或设置 WebClient 发出请求的基 URI</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Credentials</p>
                                        </td>
                                        <td>
                                            <p>获取或设置发送到主机并用于对请求进行身份验证的网络凭据</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Encoding</p>
                                        </td>
                                        <td>
                                            <p>获取和设置用于上载和下载字符串的 Encoding</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Headers</p>
                                        </td>
                                        <td>
                                            <p>获取或设置与请求关联的标头名称/值对集合</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>IsBusy</p>
                                        </td>
                                        <td>
                                            <p>获取一个值，该值指示某一 Web 请求是否处于进行中</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ResponseHeaders</p>
                                        </td>
                                        <td>
                                            <p>获取与响应关联的标头名称/值对集合</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>UseDefaultCredentials</p>
                                        </td>
                                        <td>
                                            <p>获取或设置一个 Boolean 值，该值控制默认凭据是否随请求一起发送</p>
                                        </td>
                                    </tr>
                                </table>
                                <br />
                                <p class="MsoListParagraph" style='margin-left: 21.0pt;'>
                                    l&nbsp;
                            <b>方法</b>
                                </p>
                                <table>
                                    <tr>
                                        <td>
                                            <p>CancelAsync</p>
                                        </td>
                                        <td>
                                            <p>取消一个挂起的异步操作</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>DownloadStringAsync</p>
                                        </td>
                                        <td>
                                            <p>以字符串形式下载位于指定 Uri 的资源</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>GetWebRequest</p>
                                        </td>
                                        <td>
                                            <p>为指定资源返回一个 WebRequest 对象</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>GetWebResponse</p>
                                        </td>
                                        <td>
                                            <p>使用指定的 IAsyncResult 返回指定 WebRequest 的 WebResponse</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>OpenReadAsync</p>
                                        </td>
                                        <td>
                                            <p>打开流向指定资源的可读流</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>OpenWriteAsync</p>
                                        </td>
                                        <td>
                                            <p>打开一个流以将数据写入指定的资源。</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>UploadStringAsync</p>
                                        </td>
                                        <td>
                                            <p>将指定的字符串上载到指定的资源</p>
                                        </td>
                                    </tr>
                                </table>
                                <br />
                                <p class="MsoListParagraph" style='margin-left: 21.0pt;'>
                                    l&nbsp;
                            <b>事件</b>
                                </p>
                                <table>
                                    <tr>
                                        <td>
                                            <p>DownloadProgressChanged</p>
                                        </td>
                                        <td>
                                            <p>在异步下载操作成功传输部分或全部数据后发生</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>DownloadStringCompleted</p>
                                        </td>
                                        <td>
                                            <p>在异步资源下载操作完成时发生</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>OpenReadCompleted</p>
                                        </td>
                                        <td>
                                            <p>在异步资源读取操作完成时发生</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>OpenWriteCompleted</p>
                                        </td>
                                        <td>
                                            <p>在打开流以将数据写入资源的异步操作完成时发生</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>UploadProgressChanged</p>
                                        </td>
                                        <td>
                                            <p>在异步上载操作成功传输部分或全部数据后发生</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>UploadStringCompleted</p>
                                        </td>
                                        <td>
                                            <p>在异步字符串上载操作完成时发生</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>WriteStreamClosed</p>
                                        </td>
                                        <td>
                                            <p>在异步写入流操作完成时发生</p>
                                        </td>
                                    </tr>
                                </table>
                                <h3><a name="_Toc371584154">使用WebClient类</a></h3>
                                <p>发送请求</p>
                                <p>创建实例</p><pre><code>WebClient webClient = new WebClient();</code></pre>
                                <p>设置回调</p><pre><code>webClient.DownloadStringCompleted += new DownloadStringCompletedEventHandler(webClient_DownloadStringCompleted);</code></pre>
                                <p>下载数据</p><pre><code>webClient.DownloadStringAsync(new System.Uri("http://windowsteamblog.com/windows_phone/b/windowsphone/rss.aspx"));</code></pre>
                                <h2><a name="_Toc371584155">HttpWebRequest类</a></h2>
                                <p>此类为Windows Phone使用HTTP协议获取网络数据的另外一个选择，提供 WebRequest 类的 HTTP 特定的实现。</p>
                                <p class="MsoListParagraph" style='margin-left: 21.0pt;'>
                                    l&nbsp;
                            <b>属性</b>
                                </p>
                                <table>
                                    <tr>
                                        <td>
                                            <p>Accept</p>
                                        </td>
                                        <td>
                                            <p>获取或设置 Accept HTTP 标头的值</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>AllowAutoRedirect</p>
                                        </td>
                                        <td>
                                            <p>获取或设置一个值，该值指示请求是否应跟随重定向响应</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>AllowReadStreamBuffering</p>
                                        </td>
                                        <td>
                                            <p>如果已在子类中重写，则获取或设置一个值，该值指示是否对从 Internet 资源读取的数据进行缓冲处理</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>AllowWriteStreamBuffering</p>
                                        </td>
                                        <td>
                                            <p>获取或设置一个值，该值指示是否对发送到 Internet 资源的数据进行缓冲处理</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ContentLength</p>
                                        </td>
                                        <td>
                                            <p>为设置客户端发送的内容长度（以字节计）而获取</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>ContentType</p>
                                        </td>
                                        <td>
                                            <p>获取或设置 Content-type HTTP 标头的值</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>CookieContainer</p>
                                        </td>
                                        <td>
                                            <p>指定与 HTTP 请求相关联的 CookieCollection 对象的集合</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>CreatorInstance</p>
                                        </td>
                                        <td>
                                            <p>
                                                当在子类中重写时，获取从 IWebRequestCreate 类派生的工厂对象，该类用于创建为生成对指定
  URI 的请求而实例化的 WebRequest
                                            </p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Credentials</p>
                                        </td>
                                        <td>
                                            <p>获取或设置请求的身份验证信息</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>HaveResponse</p>
                                        </td>
                                        <td>
                                            <p>获取一个值，该值指示是否已收到来自 Internet 资源的响应</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Headers</p>
                                        </td>
                                        <td>
                                            <p>指定一个组成 HTTP 标头的名称/值对集合</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Method</p>
                                        </td>
                                        <td>
                                            <p>获取或设置请求的方法</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>RequestUri</p>
                                        </td>
                                        <td>
                                            <p>获取请求的原始统一资源标识符</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>SupportsCookieContainer</p>
                                        </td>
                                        <td>
                                            <p>获取一个值，该值指示 CookieContainer 属性是否由 HttpWebRequest 实例支持</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>UseDefaultCredentials</p>
                                        </td>
                                        <td>
                                            <p>当在子代类中重写时，获取或设置一个 Boolean 值，该值控制默认凭据是否随请求一起发送。</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>UserAgent</p>
                                        </td>
                                        <td>
                                            <p>获取或设置 User-agent HTTP 标头的值</p>
                                        </td>
                                    </tr>
                                </table>
                                <br />
                                <p class="MsoListParagraph" style='margin-left: 21.0pt;'>
                                    l&nbsp;
                            <b>方法</b>
                                </p>
                                <table>
                                    <tr>
                                        <td>
                                            <p>Abort</p>
                                        </td>
                                        <td>
                                            <p>取消对 Internet 资源的请求</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>BeginGetRequestStream</p>
                                        </td>
                                        <td>
                                            <p>开始对用来写入数据的 Stream 对象的异步请求</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>BeginGetResponse</p>
                                        </td>
                                        <td>
                                            <p>开始对 Internet 资源的异步请求</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>EndGetRequestStream</p>
                                        </td>
                                        <td>
                                            <p>结束对用于写入数据的 Stream 对象的异步请求</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>EndGetResponse</p>
                                        </td>
                                        <td>
                                            <p>结束对 Internet 资源的异步请求</p>
                                        </td>
                                    </tr>
                                </table>
                                <br />
                                <p class="MsoListParagraph" style='margin-left: 21.0pt;'>
                                    l&nbsp;
                            <b>扩展方法</b>
                                </p>
                                <table>
                                    <tr>
                                        <td>
                                            <p>GetCurrentNetworkInterface</p>
                                        </td>
                                        <td>
                                            <p>获取有关与 Web 请求相对应的网络接口的所有可用信息</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>SetNetworkPreference</p>
                                        </td>
                                        <td>
                                            <p>设置 Web 请求的首选项，以使用蜂窝或非蜂窝技术</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>SetNetworkRequirement</p>
                                        </td>
                                        <td>
                                            <p>设置 Web 请求的要求，以使用蜂窝或非蜂窝技术</p>
                                        </td>
                                    </tr>
                                </table>
                                <h3><a name="_Toc371584156">使用HttpWebRequest类发送GET和POST请求</a></h3>
                                <p class="MsoListParagraph" style='margin-left: 18.0pt;'>
                                    1.
创建实例
                                </p>
                                <p class="MsoListParagraph" style='margin-left: 18.0pt;'>使用WebRequest的Create方法创建实例。</p><pre><code>var forecastRequest =WebRequest.Create(Uri)</code></pre>
                                <p class="MsoListParagraph" style='margin-left: 18.0pt;'>
                                    2.设置请求类型
                                </p>
                                <p class="MsoListParagraph" style='margin-left: 18.0pt; text-autospace: none'>
                                    当请求类型为GET时 forecastRequest.Method =
&quot;GET&quot;
                                </p>
                                <p class="MsoListParagraph" style='margin-left: 18.0pt; text-autospace: none'>
                                    当请求类型为POST时 forecastRequest.Method =
&quot;POST&quot;
                                </p>
                                <p class="MsoListParagraph" style='margin-left: 18.0pt;'>
                                    3.
添加RequestHeader
                                </p>
                                <p class="MsoListParagraph" style='margin-left: 18.0pt;'>可以使用HttpWebRequest的Headers设置请求的消息头，如：</p><pre><code>forecastRequest.Headers["Encoding-Type"] = "gzip";</code></pre>
                                <p class="MsoListParagraph" style='margin-left: 18.0pt;'>
                                    4.
添加RequestEntity
                                </p>
                                <p class="MsoListParagraph" style='margin-left: 18.0pt;'>若请求为POST时，需要向请求中添加消息体。使用BeginGetRequestStream()方法可以以流的方式添加消息体。</p>
                                <p class="MsoListParagraph" style='margin-left: 18.0pt;'>
                                    5.
发送请求并获取数据
                                </p>
                                <p class="MsoListParagraph" style='margin-left: 18.0pt;'>使用BeginGetResponse()方法可以获得请求的响应消息。如：</p><pre><code>forecastRequest.BeginGetResponse(new AsyncCallback(HandleForecastResponse),forecastState);</code></pre>
                                <p style='text-autospace: none'>
                                    更多内容请参考：<a
                                        href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.net.webclient(v=vs.105).aspx">WebClient</a> 和&nbsp;<a
                                            href="http://msdn.microsoft.com/zh-cn/library/windowsphone/develop/system.net.httpwebrequest(v=vs.105).aspx">HttpWebRequest</a>&nbsp;
                                </p>
                                <h1><a name="_Toc371584157">Window8 Web服务</a></h1>
                                <h2><a name="_Toc371584158">HttpClient</a></h2>
                                <p>
                                    HttpClient
类用于通过
HTTP 发送和接收基本要求。它提供了一个用于从 URI 所标识的资源发送 HTTP 请求和接收 HTTP 响应的基类。该类可用来向 Web 服务发送 GET、PUT、POST、DELETE 以及其他请求。上述每种请求都作为异步操作进行发送。
                                </p>
                                <p>
                                    HttpResponseMessage
类用于声明从
HTTP 请求接收到的 HTTP 响应消息。
                                </p>
                                <p>
                                    HttpContent
类是用于声明
HTTP 实体正文和内容标题的基类。 在这种情况下，HttpContent 用于声明 HTTP 响应。
                                </p>
                                <br />
                                <p class="MsoListParagraph" style='margin-left: 21.0pt;'>
                                    l&nbsp;
                            <b>HttpClient</b><b>类属性</b>
                                </p>
                                <table>
                                    <tr>
                                        <td>
                                            <p>BaseAddress</p>
                                        </td>
                                        <td>
                                            <p>获取或设置发送请求时使用的 Internet 资源的统一资源标识符 (URI) 的基地址</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>DefaultRequestHeaders</p>
                                        </td>
                                        <td>
                                            <p>获取与每个请求一起发送的标题</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>MaxResponseContentBufferSize</p>
                                        </td>
                                        <td>
                                            <p>获取或设置读取响应内容时要缓冲的最大字节数</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>Timeout</p>
                                        </td>
                                        <td>
                                            <p>获取或设置请求超时前等待的毫秒数</p>
                                        </td>
                                    </tr>
                                </table>
                                <br />
                                <p class="MsoListParagraph" style='margin-left: 21.0pt;'>
                                    l&nbsp;
                            <b>HttpClient</b><b>主要方法</b>
                                </p>
                                <table>
                                    <tr>
                                        <td>
                                            <p>CancelPendingRequests</p>
                                        </td>
                                        <td>
                                            <p>取消该实例所有挂起的请求</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>DeleteAsync</p>
                                        </td>
                                        <td>
                                            <p>以异步操作发送 DELETE 请求</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>GetAsync</p>
                                        </td>
                                        <td>
                                            <p>以异步操作发送 GET 请求</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>GetByteArrayAsync</p>
                                        </td>
                                        <td>
                                            <p>发送 GET 请求并在异步操作中以字节数组的形式返回响应正文</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>GetStreamAsync</p>
                                        </td>
                                        <td>
                                            <p>发送 GET 请求并在异步操作中以流的形式返回响应正文</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>GetStringAsync</p>
                                        </td>
                                        <td>
                                            <p>发送 GET 请求并在异步操作中以字符串的形式返回响应正文</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>PostAsync</p>
                                        </td>
                                        <td>
                                            <p>以异步操作发送 POST 请求</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>PutAsync</p>
                                        </td>
                                        <td>
                                            <p>以异步操作发送 PUT 请求</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <p>SendAsync</p>
                                        </td>
                                        <td>
                                            <p>以异步操作发送 HTTP 请求</p>
                                        </td>
                                    </tr>
                                </table>
                                <h3><a name="_Toc371584159">使用HttpClient类发送GET请求</a></h3>
                                <pre>创建HttpClient实例，如：</pre>
                                <pre><code>HttpClient client = new HttpClient();</code></pre>
                                <p>设置Web 服务的响应接受的数据量，如：</p><pre><code>httpClient.MaxResponseContentBufferSize = 256000;</code></pre>
                                <p>设置请求消息头，如: </p><pre><code>httpClient.DefaultRequestHeaders.Add("user-agent", "Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; WOW64; Trident/6.0)");</code></pre>
                                <p>设置超时时间，如：</p><pre><code>httpClient.Timeout = new TimeSpan(10000);</code></pre>
                                <h3><a name="_Toc371584160">使用HttpClient类和HttpRequestMessage 类发送POST请求</a></h3>
                                <p>HttpRequestMessage可以设置请求的类型，如POST、GET等，请求的地址以及请求的消息头消息体。</p>
                                <p>HttpClient类发送POST请求可以使用HttpClient.SendAsync(HttpRequestMessage)方法。如：</p><pre><code>Stream stream = GenerateSampleStream(1000);
StreamContent streamContent = new StreamContent(stream);
string resourceAddress = AddressField.Text.Trim();
HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, resourceAddress);
request.Content = streamContent;
request.Headers.TransferEncodingChunked = true;
HttpResponseMessage response = await httpClient.SendAsync(request);</code></pre>
                                <h3><a name="_Toc371584161">获得请求返回数据</a></h3>
                                <p>HttpResponseMessage中有请求返回的数据，可以通过ReadAsStringAsync()以string方式异步读取消息体，也可以使用ReadAsStreamAsync()以流的方式异步读取消息体。</p>
                                <p>如：</p><pre><code>HttpResponseMessage response = await httpClient.SendAsync(request);
String responseBodyAsText = await response.Content.ReadAsStringAsync();
Stream responseStream = await response.Content.ReadAsStreamAsync()</code></pre>
                                <p>
                                    更多内容请参考：<a
                                        href="http://msdn.microsoft.com/zh-cn/library/windows/apps/hh781239.aspx">快速入门：使用 HttpClient 进行连接</a>
                                </p>
                                <h1><a name="_Toc371584162">AndroidWeb服务</a></h1>
                                <p>以下以DefaultHttpClient介绍Andriod中通过http协议发送和接受网络数据的方法</p>
                                <h2><a name="_Toc371584163">发送GET请求</a></h2>
                                <p>下面代码展示了Android使用DefaultHttpClient发送GET请求：</p><pre><code>String httpUrl = "http://192.168.0.132:8080/Android/httpreq.jsp?par=request-get";
                HttpGet request = new HttpGet(httpUrl);
                HttpClient httpClient = new DefaultHttpClient();
                try {
                    HttpResponse response = httpClient.execute(request);
                    if(response.getStatusLine().getStatusCode()==HttpStatus.SC_OK){
                        String str = EntityUtils.toString(response.getEntity());
                        tv_rp.setText(str);
                    }else{
                        tv_rp.setText("请求错误");
                    } 
                } catch (ClientProtocolException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();    
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }</code></pre>
                                <h2><a name="_Toc371584164">发送POST请求</a></h2>
                                <p>下面代码展示了使用DefaultHttpClient发送POST请求：</p><pre><code>String httpUrl = "http://192.168.0.132:8080/Android/httpreq.jsp";
                HttpPost request = new HttpPost(httpUrl);
                List<NameValuePair> params = new ArrayList<NameValuePair>();
                params.add(new BasicNameValuePair("par","request-post"));
                try {
                    HttpEntity entity = new UrlEncodedFormEntity(params, "UTF-8");
                    request.setEntity(entity);
                    HttpClient client = new DefaultHttpClient();
                    HttpResponse response = client.execute(request);
                    if(response.getStatusLine().getStatusCode()==HttpStatus.SC_OK){
                        String str = EntityUtils.toString(response.getEntity());
                        tv_rp.setText(str);
                    }else{
                        tv_rp.setText("请求错误");
                    }
                } catch (UnsupportedEncodingException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (ClientProtocolException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }</code></pre>
                                <h1><a name="_Toc371584165">IOS web服务</a></h1>
                                <p>以下以NSMutableURLRequest（NSURLRequest的子类）为例，介绍IOS中通过http发送和接受网络数据的方法。</p>
                                <h2><a name="_Toc371584166">发送Get请求：</a></h2><pre><code>NSURL *url = [NSURL URLWithString:URLString];
    NSMutableURLRequest  *request = [[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:url];
    [request setHTTPMethod:@"GET"];
    NSURLConnection *conn = [[[NSURLConnection alloc] initWithRequest:request delegate:nil] autorelease];
    [conn start];
    NSURL *url = [NSURL URLWithString:URLString];
    NSMutableURLRequest  *request = [[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:url];
    [request setHTTPMethod:@"GET"];
    NSURLConnection *conn = [[[NSURLConnection alloc] initWithRequest:request delegate:nil] autorelease];
    [conn start];</code></pre>
                                <h2><a name="_Toc371584167">发送Post请求：</a></h2><pre><code>NSURL *url = [NSURL URLWithString:URLString];
NSData* data = xxxxxxxxxxx;
NSMutableURLRequest  *request = [[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:url];
    [request setHTTPMethod:@"POST"];
    [request setHTTPBody:data];
    [request setValue:@"application/json" forHTTPHeaderField:@"Accept"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
    [request setValue:[NSString stringWithFormat:@"%d", [data length]] forHTTPHeaderField:@"Content-Length"];
    NSURLConnection *conn = [[[NSURLConnection alloc] initWithRequest:request delegate:nil] autorelease];
[conn start];</code></pre>
                                <h1><a name="_Toc371584168">序列化和反序列化</a></h1>
                                <p>在Http请求中，请求和响应的实体通常为XML或Json格式。</p>
                                <h2><a name="_Toc371584169">XML</a></h2>
                                <h3><a name="_Toc371584170">Windows phone和Windows</a></h3>
                                <p>System.Xml.Serialization命名空间下提供XmlSerializer类，将对象序列化到 XML 文档中和从 XML 文档中反序列化对象。如下代码展示了如何使用XmlSerializer类</p>
                                <p>序列化</p><pre><code>Object obj;
var type = obj.GetType();
var xmlSerializer = new XmlSerializer(type);
var sb = new StringBuilder();
xmlSerializer.Serialize(XmlWriter.Create(sb), obj);
反序列化
var xmlSerializer = new XmlSerializer(typeof(T));
var stringReader = new StringReader(xml);
obj = (T)xmlSerializer.Deserialize(stringReader);</code></pre>
                                <h3><a name="_Toc371584171">Android</a></h3>
                                <p>在Android平台上可以使用Simple API for XML(SAX) 、 Document Object Model(DOM)和Android附带的pull解析器解析XML文件。SAX解析器的优点是解析速度快，占用内存少。非常适合在Android移动设备中使用。由于DOM在内存中以树形结构存放，因此检索和更新效率会更高。但是对于特别大的文档，解析和加载整个文档将会很耗资源。PULL解析器小巧轻便，解析速度快，简单易用，非常适合在Android移动设备中使用，Android系统内部在解析各种XML时也是用PULL解析器</p>
                                <h3><a name="_Toc371584172">Ios </a></h3>
                                <p>
                                    iOS
SDK提供了NSXMLParser和libxml2两个类库
                                </p>
                                <p style='margin-left: 33.75pt;'>
                                    ●
NSXMLParser，<a
    href="http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html">NSXMLParser Class Reference</a> ，这是一个SAX方式解析XML的类库，默认包含在iOS
SDK中，使用也比较简单。
                                </p>
                                <p style='margin-left: 33.75pt;'>
                                    ●
libxml2，<a
    href="http://xmlsoft.org/">http://xmlsoft.org/</a>，是一套默认包含在iOS SDK中的开源类库，它是基于C语言的API，所以使用起来可能不如NSXML方便。这套类库同时支持DOM和SAX解析，libxml2的SAX解析方式还是非常酷的，因为它可以边读取边解析，尤其是在从网上下载一个很大的XML文件，就可以一边下载一边对已经下载好的内容进行解析，极大的提高解析效率
                                </p>
                                <h2><a name="_Toc371584173">Json</a></h2>
                                <h3><a name="_Toc371584174">Windows phone和Windows</a></h3>
                                <p>System.Runtime.Serialization.Json提供DataContractJsonSerializer类对Json进行序列化和反序列化为对象。如下代码展示如何使用DataContractJsonSerializer</p>
                                <p>对象转化为JSON字符串使用WriteObject方法：</p><pre><code>var config = new Config(){
                         encoding = "UTF-8",
                         plugins = new string[]{"python", "C++", "C#"},
                         indent = new Indent(){ length = 4, use_space = false}
                         };
var serializer = new DataContractJsonSerializer(typeof(Config));
var stream = new MemoryStream();
serializer.WriteObject(stream, config);
byte[] dataBytes = new byte[stream.Length];
stream.Position = 0;
stream.Read(dataBytes, 0, (int)stream.Length);
string dataString = Encoding.UTF8.GetString(dataBytes);</code></pre>
                                <p>JSON字符串转对象使用ReadObject方法：</p><pre><code>var mStream = new MemoryStream(Encoding.Default.GetBytes(dataString));
Config readConfig = (Config)serializer.ReadObject(mStream);</code></pre>
                                <h3><a name="_Toc371584175">Android</a></h3>
                                <p>android的json解析部分都在包org.json下，主要有以下几个类：</p>
                                <p>JSONObject可以看作是一个json对象,这是系统中有关JSON定义的基本单元，其包含一对儿(Key/Value)数值</p>
                                <p>JSONStringer构建json文本</p>
                                <p>JSONArray、它代表一组有序的数值。将其转换为String输出(toString)所表现的形式是用方括号包裹，数值以逗号”,”分隔</p>
                                <p>JSONTokener按照RFC4627规范将json文本解析为相应的对象。</p>
                                <p>
                                    JSONException
处理json解析异常
                                </p>
                                <h3><a name="_Toc371584176">IOS</a></h3>
                                <p>在ios5中，苹果引入了NSJSONSerialization用来序列化和反序列化json数据，</p>
                                <p class="MsoListParagraph" style='margin-top: 7.5pt; margin-right: 0cm; margin-bottom: 7.5pt; margin-left: 36.0pt;'>
                                    通过NSJSONSerialization这个类的JSONObjectWithData:options:error:方法来实现反序列化。&nbsp;
                                </p>
                                <p class="MsoListParagraph" style='margin-top: 7.5pt; margin-right: 0cm; margin-bottom: 7.5pt; margin-left: 36.0pt;'>
                                    通过NSJSONSerialization这个类的dataWithJSONObject:options:error:方法来实现序列化
                                </p>
                                <br />
                            </div>
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>
            </div>
        </div>
        <!--End Content-->
        <div style="text-align: right" class="gotoTop"><a href="javascript:scroll(0,0)"></a></div>
        <!--Begin ProudctLinks-->
        <div class="ms-pro-links">
            <div class="grid-container clearfix">
                <div class="cam-links">
                    其它微软站点
		<a href="http://www.microsoft.com/zh-cn/default.aspx">微软中国官方网站</a>
                    <a href="http://www.microsoft.com/zh-cn/download/default.aspx?WT.mc_id=MSCOM_zh-cn_HP_Footer_downloads" target="_blank">微软中国下载中心</a>
                    <a href="http://www.microsoftstore.com.cn?WT.mc_id=MSCOM_003" target="_blank">微软中国官方商城</a>
                    <a href="http://www.microsoft.com/china/newsletter/" target="_blank">订阅电子期刊</a>
                    <a href="https://sales.liveperson.net/hc/21661174/?cmd=file&file=visitorWantsToChat&site=21661174&byhref=1&SESSIONVAR!skill=APGC.PRC.ZH.CS.CON.PRESLS.GENERAL" target="_blank">联系微软销售代表</a>
                    <a href="http://www.microsoft.com/zh-cn/sitemap.aspx" target="_blank">网站地图</a>
                </div>
            </div>
        </div>
        <!--End ProudctLinks-->
        <!--Begin footer-->
        <div class="footer">
            <div class="grid-container">
                <img src="http://i.s-microsoft.com/global/ImageStore/PublishingImages/logos/hp/logo-type-1x.png" alt="microsoft" class="logo">
                <ul>
                    <li><a href="http://www.miibeian.gov.cn/" title="">京ICP备09042378号-6</a></li>
                    <li><a href="https://profile.microsoft.com/RegSysProfileCenter/default.aspx?lcid=2052" title="">个人信息中心</a></li>
                    <li><a href="http://support.microsoft.com/contactus/?ws=support" title="">与我们联系</a></li>
                    <li><a href="http://go.microsoft.com/fwlink/?LinkId=248681" title="">隐私权声明</a></li>
                    <li><a href="http://go.microsoft.com/?linkid=4412892" title="">使用条款</a></li>
                    <li><a href="http://www.microsoft.com/About/Legal/EN/US/IntellectualProperty/Trademarks/EN-US.aspx" title="">商标</a></li>
                    <li>&copy; 2013 Microsoft</li>
                </ul>
            </div>
        </div>
        <!--End footer-->
        <!-- Begin MDA WEDCS -->
        <script type="text/JavaScript">
            var varSegmentation = 0;
            var varClickTracking = 1;
            var varCustomerTracking = 1;
            var varAutoFirePV = 1;
            var Route = "#";
            var Ctrl = "#"
            //document.write("<script type='text/javascript' src='" + window.location.protocol + "//c.microsoft.com/ms.js'><"+"/script>");
        </script>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script type="text/javascript" src="./assets/js/script.js"></script>
        <script type="text/javascript" src="./js/siteSearch.js"></script>
        <noscript>
            <img alt="" width="1" height="1" src="http://c.microsoft.com/trans_pixel.aspx/" /></noscript>
        <!-- Begin MDA WEDCS -->
    </div>
</body>
</html>
